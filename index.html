<!doctype html>
<html lang="it" class="h-full">
Â <head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>Piattaforma CSIRT - Gestione Sicurezza Aziendale</title>
Â  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
Â  <style>
Â  Â  * { box-sizing: border-box; margin: 0; padding: 0; }
Â  Â  body {
Â  Â  Â  box-sizing: border-box;
Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
Â  Â  Â  line-height: 1.5;
Â  Â  }
Â  Â Â 
Â  Â  /* Utility Classes */
Â  Â  .fixed { position: fixed; }
Â  Â  .absolute { position: absolute; }
Â  Â  .relative { position: relative; }
Â  Â  .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
Â  Â Â 
Â  Â  .flex { display: flex; }
Â  Â  .inline-flex { display: inline-flex; }
Â  Â  .grid { display: grid; }
Â  Â  .hidden { display: none; }
Â  Â Â 
Â  Â  .flex-col { flex-direction: column; }
Â  Â  .flex-1 { flex: 1 1 0%; }
Â  Â  .flex-shrink-0 { flex-shrink: 0; }
Â  Â  .items-start { align-items: flex-start; }
Â  Â  .items-center { align-items: center; }
Â  Â  .items-stretch { align-items: stretch; }
Â  Â  .justify-start { justify-content: flex-start; }
Â  Â  .justify-end { justify-content: flex-end; }
Â  Â  .justify-center { justify-content: center; }
Â  Â  .justify-between { justify-content: space-between; }
Â  Â Â 
Â  Â  .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
Â  Â  .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
Â  Â  .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
Â  Â Â 
Â  Â  .gap-2 { gap: 0.5rem; }
Â  Â  .gap-3 { gap: 0.75rem; }
Â  Â  .gap-4 { gap: 1rem; }
Â  Â  .gap-6 { gap: 1.5rem; }
Â  Â Â 
Â  Â  .space-x-2 > * + * { margin-left: 0.5rem; }
Â  Â  .space-x-3 > * + * { margin-left: 0.75rem; }
Â  Â  .space-x-4 > * + * { margin-left: 1rem; }
Â  Â  .space-x-6 > * + * { margin-left: 1.5rem; }
Â  Â  .space-y-1 > * + * { margin-top: 0.25rem; }
Â  Â  .space-y-2 > * + * { margin-top: 0.5rem; }
Â  Â  .space-y-3 > * + * { margin-top: 0.75rem; }
Â  Â  .space-y-4 > * + * { margin-top: 1rem; }
Â  Â  .space-y-6 > * + * { margin-top: 1.5rem; }
Â  Â  .space-y-8 > * + * { margin-top: 2rem; }
Â  Â Â 
Â  Â  .overflow-hidden { overflow: hidden; }
Â  Â  .overflow-y-auto { overflow-y: auto; }
Â  Â  .overflow-x-auto { overflow-x: auto; }
Â  Â Â 
Â  Â  .rounded { border-radius: 0.25rem; }
Â  Â  .rounded-lg { border-radius: 0.5rem; }
Â  Â  .rounded-xl { border-radius: 0.75rem; }
Â  Â  .rounded-2xl { border-radius: 1rem; }
Â  Â  .rounded-full { border-radius: 9999px; }
Â  Â  .rounded-t-xl { border-top-left-radius: 0.75rem; border-top-right-radius: 0.75rem; }
Â  Â  .rounded-b-xl { border-bottom-left-radius: 0.75rem; border-bottom-right-radius: 0.75rem; }
Â  Â Â 
Â  Â  .border { border-width: 1px; }
Â  Â  .border-2 { border-width: 2px; }
Â  Â  .border-4 { border-width: 4px; }
Â  Â  .border-t { border-top-width: 1px; }
Â  Â  .border-t-2 { border-top-width: 2px; }
Â  Â  .border-t-4 { border-top-width: 4px; }
Â  Â  .border-b { border-bottom-width: 1px; }
Â  Â  .border-b-2 { border-bottom-width: 2px; }
Â  Â  .border-l-4 { border-left-width: 4px; }
Â  Â  .border-gray-200 { border-color: #e5e7eb; }
Â  Â  .border-gray-300 { border-color: #d1d5db; }
Â  Â  .border-blue-500 { border-color: #3b82f6; }
Â  Â  .border-blue-600 { border-color: #2563eb; }
Â  Â  .border-green-500 { border-color: #22c55e; }
Â  Â  .border-purple-500 { border-color: #a855f7; }
Â  Â  .border-red-500 { border-color: #ef4444; }
Â  Â  .border-yellow-500 { border-color: #eab308; }
Â  Â Â 
Â  Â  .bg-white { background-color: #ffffff; }
Â  Â  .bg-gray-50 { background-color: #f9fafb; }
Â  Â  .bg-gray-100 { background-color: #f3f4f6; }
Â  Â  .bg-gray-200 { background-color: #e5e7eb; }
Â  Â  .bg-gray-300 { background-color: #d1d5db; }
Â  Â  .bg-gray-500 { background-color: #6b7280; }
Â  Â  .bg-gray-600 { background-color: #4b5563; }
Â  Â  .bg-gray-800 { background-color: #1f2937; }
Â  Â  .bg-red-50 { background-color: #fef2f2; }
Â  Â  .bg-red-100 { background-color: #fee2e2; }
Â  Â  .bg-red-500 { background-color: #ef4444; }
Â  Â  .bg-red-600 { background-color: #dc2626; }
Â  Â  .bg-yellow-50 { background-color: #fefce8; }
Â  Â  .bg-yellow-100 { background-color: #fef3c7; }
Â  Â  .bg-yellow-500 { background-color: #eab308; }
Â  Â  .bg-yellow-600 { background-color: #ca8a04; }
Â  Â  .bg-green-50 { background-color: #f0fdf4; }
Â  Â  .bg-green-100 { background-color: #dcfce7; }
Â  Â  .bg-green-500 { background-color: #22c55e; }
Â  Â  .bg-green-600 { background-color: #16a34a; }
Â  Â  .bg-blue-50 { background-color: #eff6ff; }
Â  Â  .bg-blue-100 { background-color: #dbeafe; }
Â  Â  .bg-blue-500 { background-color: #3b82f6; }
Â  Â  .bg-blue-600 { background-color: #2563eb; }
Â  Â  .bg-blue-800 { background-color: #1e40af; }
Â  Â  .bg-purple-50 { background-color: #faf5ff; }
Â  Â  .bg-purple-100 { background-color: #f3e8ff; }
Â  Â  .bg-purple-600 { background-color: #9333ea; }
Â  Â  .bg-purple-800 { background-color: #6b21a8; }
Â  Â  .bg-orange-100 { background-color: #ffedd5; }
Â  Â  .bg-orange-600 { background-color: #ea580c; }
Â  Â Â 
Â  Â  .bg-gradient-to-r { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
Â  Â  .bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
Â  Â  .from-blue-600 { --tw-gradient-from: #2563eb; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(37, 99, 235, 0)); }
Â  Â  .to-blue-800 { --tw-gradient-to: #1e40af; }
Â  Â  .from-gray-50 { --tw-gradient-from: #f9fafb; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(249, 250, 251, 0)); }
Â  Â  .to-gray-100 { --tw-gradient-to: #f3f4f6; }
Â  Â Â 
Â  Â  .p-1 { padding: 0.25rem; }
Â  Â  .p-2 { padding: 0.5rem; }
Â  Â  .p-3 { padding: 0.75rem; }
Â  Â  .p-4 { padding: 1rem; }
Â  Â  .p-6 { padding: 1.5rem; }
Â  Â  .p-8 { padding: 2rem; }
Â  Â  .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
Â  Â  .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
Â  Â  .px-4 { padding-left: 1rem; padding-right: 1rem; }
Â  Â  .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
Â  Â  .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
Â  Â  .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
Â  Â  .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
Â  Â  .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
Â  Â  .py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
Â  Â  .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
Â  Â  .pt-2 { padding-top: 0.5rem; }
Â  Â  .pt-6 { padding-top: 1.5rem; }
Â  Â  .pb-2 { padding-bottom: 0.5rem; }
Â  Â Â 
Â  Â  .m-2 { margin: 0.5rem; }
Â  Â  .m-4 { margin: 1rem; }
Â  Â  .mx-2 { margin-left: 0.5rem; margin-right: 0.5rem; }
Â  Â  .mx-4 { margin-left: 1rem; margin-right: 1rem; }
Â  Â  .mx-auto { margin-left: auto; margin-right: auto; }
Â  Â  .my-2 { margin-top: 0.5rem; margin-bottom: 0.5rem; }
Â  Â  .mt-1 { margin-top: 0.25rem; }
Â  Â  .mt-2 { margin-top: 0.5rem; }
Â  Â  .mt-3 { margin-top: 0.75rem; }
Â  Â  .mt-4 { margin-top: 1rem; }
Â  Â  .mt-6 { margin-top: 1.5rem; }
Â  Â  .mt-8 { margin-top: 2rem; }
Â  Â  .mb-1 { margin-bottom: 0.25rem; }
Â  Â  .mb-2 { margin-bottom: 0.5rem; }
Â  Â  .mb-3 { margin-bottom: 0.75rem; }
Â  Â  .mb-4 { margin-bottom: 1rem; }
Â  Â  .mb-6 { margin-bottom: 1.5rem; }
Â  Â  .mb-8 { margin-bottom: 2rem; }
Â  Â  .ml-2 { margin-left: 0.5rem; }
Â  Â  .ml-3 { margin-left: 0.75rem; }
Â  Â  .ml-4 { margin-left: 1rem; }
Â  Â  .ml-auto { margin-left: auto; }
Â  Â  .mr-4 { margin-right: 1rem; }
Â  Â Â 
Â  Â  .block { display: block; }
Â  Â  .inline-block { display: inline-block; }
Â  Â Â 
Â  Â  .w-4 { width: 1rem; }
Â  Â  .w-5 { width: 1.25rem; }
Â  Â  .w-6 { width: 1.5rem; }
Â  Â  .w-8 { width: 2rem; }
Â  Â  .w-10 { width: 2.5rem; }
Â  Â  .w-16 { width: 4rem; }
Â  Â  .w-64 { width: 16rem; }
Â  Â  .w-full { width: 100%; }
Â  Â  .max-w-md { max-width: 28rem; }
Â  Â  .max-w-2xl { max-width: 42rem; }
Â  Â  .max-w-3xl { max-width: 48rem; }
Â  Â  .max-w-4xl { max-width: 56rem; }
Â  Â  .max-w-7xl { max-width: 80rem; }
Â  Â Â 
Â  Â  .h-1 { height: 0.25rem; }
Â  Â  .h-4 { height: 1rem; }
Â  Â  .h-5 { height: 1.25rem; }
Â  Â  .h-6 { height: 1.5rem; }
Â  Â  .h-8 { height: 2rem; }
Â  Â  .h-10 { height: 2.5rem; }
Â  Â  .h-16 { height: 4rem; }
Â  Â  .h-full { height: 100%; }
Â  Â  .h-auto { height: auto; }
Â  Â  .max-h-\[90vh\] { max-height: 90vh; }
Â  Â Â 
Â  Â  .min-h-full { min-height: 100%; }
Â  Â Â 
Â  Â  .text-xs { font-size: 0.75rem; line-height: 1rem; }
Â  Â  .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
Â  Â  .text-base { font-size: 1rem; line-height: 1.5rem; }
Â  Â  .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
Â  Â  .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
Â  Â  .text-2xl { font-size: 1.5rem; line-height: 2rem; }
Â  Â  .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
Â  Â Â 
Â  Â  .font-medium { font-weight: 500; }
Â  Â  .font-semibold { font-weight: 600; }
Â  Â  .font-bold { font-weight: 700; }
Â  Â Â 
Â  Â  .text-left { text-align: left; }
Â  Â  .text-center { text-align: center; }
Â  Â  .text-right { text-align: right; }
Â  Â Â 
Â  Â  .text-white { color: #ffffff; }
Â  Â  .text-gray-100 { color: #f3f4f6; }
Â  Â  .text-gray-200 { color: #e5e7eb; }
Â  Â  .text-gray-400 { color: #9ca3af; }
Â  Â  .text-gray-500 { color: #6b7280; }
Â  Â  .text-gray-600 { color: #4b5563; }
Â  Â  .text-gray-700 { color: #374151; }
Â  Â  .text-gray-800 { color: #1f2937; }
Â  Â  .text-gray-900 { color: #111827; }
Â  Â  .text-red-600 { color: #dc2626; }
Â  Â  .text-red-700 { color: #b91c1c; }
Â  Â  .text-red-800 { color: #991b1b; }
Â  Â  .text-yellow-600 { color: #ca8a04; }
Â  Â  .text-yellow-800 { color: #854d0e; }
Â  Â  .text-green-600 { color: #16a34a; }
Â  Â  .text-green-800 { color: #166534; }
Â  Â  .text-blue-100 { color: #dbeafe; }
Â  Â  .text-blue-500 { color: #3b82f6; }
Â  Â  .text-blue-600 { color: #2563eb; }
Â  Â  .text-blue-800 { color: #1e40af; }
Â  Â  .text-purple-600 { color: #9333ea; }
Â  Â  .text-purple-800 { color: #6b21a8; }
Â  Â  .text-orange-600 { color: #ea580c; }
Â  Â Â 
Â  Â  .uppercase { text-transform: uppercase; }
Â  Â Â 
Â  Â  .shadow { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
Â  Â  .shadow-md { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
Â  Â  .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
Â  Â  .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
Â  Â  .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
Â  Â Â 
Â  Â  .divide-y > * + * { border-top-width: 1px; }
Â  Â  .divide-gray-200 > * + * { border-color: #e5e7eb; }
Â  Â Â 
Â  Â  .cursor-pointer { cursor: pointer; }
Â  Â Â 
Â  Â  .transition-colors { transition-property: background-color, border-color, color, fill, stroke; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
Â  Â  .transition-shadow { transition-property: box-shadow; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
Â  Â Â 
Â  Â  .hover\:bg-white\/10:hover { background-color: rgba(255, 255, 255, 0.1); }
Â  Â  .hover\:bg-white\/20:hover { background-color: rgba(255, 255, 255, 0.2); }
Â  Â  .hover\:bg-gray-200:hover { background-color: #e5e7eb; }
Â  Â  .hover\:bg-gray-300:hover { background-color: #d1d5db; }
Â  Â  .hover\:bg-gray-400:hover { background-color: #9ca3af; }
Â  Â  .hover\:bg-gray-600:hover { background-color: #4b5563; }
Â  Â  .hover\:bg-red-600:hover { background-color: #dc2626; }
Â  Â  .hover\:bg-red-700:hover { background-color: #b91c1c; }
Â  Â  .hover\:bg-yellow-600:hover { background-color: #ca8a04; }
Â  Â  .hover\:bg-yellow-700:hover { background-color: #a16207; }
Â  Â  .hover\:bg-green-700:hover { background-color: #15803d; }
Â  Â  .hover\:bg-blue-50:hover { background-color: #eff6ff; }
Â  Â  .hover\:bg-blue-600:hover { background-color: #2563eb; }
Â  Â  .hover\:bg-blue-700:hover { background-color: #1d4ed8; }
Â  Â  .hover\:bg-purple-700:hover { background-color: #7e22ce; }
Â  Â Â 
Â  Â  .hover\:text-gray-200:hover { color: #e5e7eb; }
Â  Â  .hover\:text-gray-700:hover { color: #374151; }
Â  Â  .hover\:text-gray-800:hover { color: #1f2937; }
Â  Â  .hover\:text-blue-800:hover { color: #1e40af; }
Â  Â  .hover\:text-yellow-800:hover { color: #854d0e; }
Â  Â  .hover\:text-green-800:hover { color: #166534; }
Â  Â  .hover\:text-red-800:hover { color: #991b1b; }
Â  Â Â 
Â  Â  .hover\:shadow-md:hover { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
Â  Â  .hover\:shadow-xl:hover { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
Â  Â Â 
Â  Â  .focus\:ring-2:focus { box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5); outline: none; }
Â  Â  .focus\:ring-blue-500:focus { box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5); }
Â  Â  .focus\:border-transparent:focus { border-color: transparent; }
Â  Â Â 
Â  Â  .z-50 { z-index: 50; }
Â  Â Â 
Â  Â  input[type="checkbox"],
Â  Â  input[type="radio"] {
Â  Â  Â  appearance: none;
Â  Â  Â  -webkit-appearance: none;
Â  Â  Â  border: 1px solid #d1d5db;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  input[type="checkbox"]:checked {
Â  Â  Â  background-color: #2563eb;
Â  Â  Â  border-color: #2563eb;
Â  Â  Â  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
Â  Â  }
Â  Â  input[type="radio"]:checked {
Â  Â  Â  background-color: #2563eb;
Â  Â  Â  border-color: #2563eb;
Â  Â  Â  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='8' cy='8' r='3'/%3e%3c/svg%3e");
Â  Â  }
Â  Â Â 
Â  Â  @media (min-width: 768px) {
Â  Â  Â  .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
Â  Â  Â  .md\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
Â  Â  Â  .md\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
Â  Â  Â  .md\:col-span-2 { grid-column: span 2 / span 2; }
Â  Â  }
Â  Â Â 
Â  Â  @media (min-width: 1024px) {
Â  Â  Â  .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
Â  Â  Â  .lg\:px-8 { padding-left: 2rem; padding-right: 2rem; }
Â  Â  }
Â  Â Â 
Â  Â  html, body { height: 100%; }
Â  Â  .hidden { display: none; }
Â  Â  .status-badge {
Â  Â  Â  padding: 0.25rem 0.75rem;
Â  Â  Â  border-radius: 9999px;
Â  Â  Â  font-size: 0.875rem;
Â  Â  Â  font-weight: 500;
Â  Â  }
Â  Â  .status-aperto { background-color: #fee2e2; color: #991b1b; }
Â  Â  .status-in-corso { background-color: #fef3c7; color: #92400e; }
Â  Â  .status-risolto { background-color: #d1fae5; color: #065f46; }
Â  Â  .severity-critical { background-color: #fecaca; color: #991b1b; }
Â  Â  .severity-high { background-color: #fed7aa; color: #9a3412; }
Â  Â  .severity-medium { background-color: #fef08a; color: #854d0e; }
Â  Â  .severity-low { background-color: #bfdbfe; color: #1e40af; }
Â  Â  .modal-overlay {
Â  Â  Â  background-color: rgba(0, 0, 0, 0.5);
Â  Â  Â  backdrop-filter: blur(2px);
Â  Â  }
Â  </style>
Â  <style>@view-transition { navigation: auto; }</style>
Â  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
Â  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
Â </head>
Â <body class="bg-gray-50 h-full">Â  <div id="login-screen" class="fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center">
Â  Â <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
Â  Â  <div class="text-center mb-8">
Â  Â  Â <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
Â  Â  Â  <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
Â  Â  Â  Â </svg>
Â  Â  Â </div>
Â  Â  Â <h1 class="text-3xl font-bold text-gray-800">Piattaforma CSIRT</h1>
Â  Â  Â <p class="text-gray-600 mt-2">Gestione Sicurezza e Compliance NIS2</p>
Â  Â  </div>
Â  Â  <form id="login-form" onsubmit="handleLogin(event)" class="space-y-6">
Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Email</label> <input type="email" id="login-email" placeholder="inserisci@email.com" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
Â  Â  Â </div>
Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Password</label> <input type="password" id="login-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
Â  Â  Â </div>
Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Profilo</label> <select id="login-role" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required> <option value="">Seleziona il tuo ruolo</option> <option value="admin">ğŸ‘‘ Amministratore</option> <option value="csirt">ğŸ›¡ï¸ Consulente/Referente CSIRT</option> <option value="azienda">ğŸ¢ Referente Aziendale</option> </select>
Â  Â  Â </div><button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg transition-colors"> Accedi alla Piattaforma </button>
Â  Â  </form>
Â  Â  <div class="mt-6 pt-6 border-t border-gray-200">
Â  Â  Â <p class="text-center text-sm text-gray-600">Demo - Credenziali di test:</p>
Â  Â  Â <div class="mt-2 space-y-1 text-xs text-gray-500">
Â  Â  Â  <p>ğŸ‘¤ Admin: admin@csirt.it / admin123</p>
Â  Â  Â  <p>ğŸ›¡ï¸ CSIRT: csirt@hub.it / csirt123</p>
Â  Â  Â  <p>ğŸ¢ Azienda: azienda@test.it / azienda123</p>
Â  Â  Â </div>
Â  Â  </div>
Â  Â </div>
Â  </div>Â  <div id="main-app" class="hidden h-full flex flex-col">Â  Â <header class="bg-gradient-to-r from-blue-600 to-blue-800 text-white shadow-lg">
Â  Â  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
Â  Â  Â <div class="flex items-center justify-between">
Â  Â  Â  <div class="flex items-center space-x-4">
Â  Â  Â  Â <svg class="w-10 h-10" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
Â  Â  Â  Â </svg>
Â  Â  Â  Â <div>
Â  Â  Â  Â  <h1 class="text-2xl font-bold">Piattaforma CSIRT</h1>
Â  Â  Â  Â  <p class="text-blue-100 text-sm">Sistema di Gestione Sicurezza e Compliance NIS2</p>
Â  Â  Â  Â </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="flex items-center space-x-4">
Â  Â  Â  Â <div class="text-right">
Â  Â  Â  Â  <p class="text-sm font-medium" id="user-name">Admin User</p>
Â  Â  Â  Â  <p class="text-xs text-blue-100" id="user-role">Amministratore</p>
Â  Â  Â  Â </div><button onclick="logout()" class="px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors flex items-center space-x-2">
Â  Â  Â  Â  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
Â  Â  Â  Â  </svg><span>Esci</span> </button>
Â  Â  Â  </div>
Â  Â  Â </div>
Â  Â  </div>
Â  Â </header>
Â  Â <div class="flex flex-1 overflow-hidden">Â  Â  <aside class="w-64 bg-white shadow-lg overflow-y-auto">
Â  Â  Â <nav class="p-4 space-y-2" id="sidebar-nav"><button onclick="showSection('dashboard')" class="nav-item flex items-center space-x-3 w-full px-4 py-3 rounded-lg bg-blue-50 text-blue-600 font-medium">
Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
Â  Â  Â  Â </svg><span>Dashboard</span> </button> <button onclick="showSection('companies')" class="nav-item flex items-center space-x-3 w-full px-4 py-3 rounded-lg hover:bg-blue-50 transition-colors" data-role="admin,csirt">
Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
Â  Â  Â  Â </svg><span>Aziende</span> </button> <button onclick="showSection('users')" class="nav-item flex items-center space-x-3 w-full px-4 py-3 rounded-lg hover:bg-blue-50 transition-colors" data-role="admin">
Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
Â  Â  Â  Â </svg><span>Utenti</span> </button> <button onclick="showSection('incidents')" class="nav-item flex items-center space-x-3 w-full px-4 py-3 rounded-lg hover:bg-blue-50 transition-colors">
Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
Â  Â  Â  Â </svg><span>Incidenti</span> </button> <button onclick="showSection('notifications')" class="nav-item flex items-center space-x-3 w-full px-4 py-3 rounded-lg hover:bg-blue-50 transition-colors" data-role="admin,csirt">
Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
Â  Â  Â  Â </svg><span>Notifiche ACN</span> </button>
Â  Â  Â </nav>
Â  Â  </aside>Â  Â  <main class="flex-1 overflow-y-auto p-8">Â  Â  Â <section id="dashboard-section" class="section-content">
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800 mb-6">Dashboard Generale</h2>Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
Â  Â  Â  Â <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-blue-500">
Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â <div>
Â  Â  Â  Â  Â  <p class="text-gray-500 text-sm font-medium">Aziende Monitorate</p>
Â  Â  Â  Â  Â  <p id="total-companies" class="text-3xl font-bold text-gray-800 mt-2">0</p>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â <div class="bg-blue-100 p-3 rounded-full">
Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>
Â  Â  Â  Â <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-red-500">
Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â <div>
Â  Â  Â  Â  Â  <p class="text-gray-500 text-sm font-medium">Incidenti Aperti</p>
Â  Â  Â  Â  Â  <p id="open-incidents" class="text-3xl font-bold text-gray-800 mt-2">0</p>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â <div class="bg-red-100 p-3 rounded-full">
Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>
Â  Â  Â  Â <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-yellow-500">
Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â <div>
Â  Â  Â  Â  Â  <p class="text-gray-500 text-sm font-medium">Notifiche Pending</p>
Â  Â  Â  Â  Â  <p id="pending-notifications" class="text-3xl font-bold text-gray-800 mt-2">0</p>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â <div class="bg-yellow-100 p-3 rounded-full">
Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>
Â  Â  Â  Â <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-green-500">
Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â <div>
Â  Â  Â  Â  Â  <p class="text-gray-500 text-sm font-medium">Compliance Score</p>
Â  Â  Â  Â  Â  <p id="compliance-score" class="text-3xl font-bold text-gray-800 mt-2">0%</p>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â <div class="bg-green-100 p-3 rounded-full">
Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>
Â  Â  Â  </div>Â  Â  Â  <div class="bg-white rounded-xl shadow-md p-6 mb-8">
Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4">AttivitÃ  Recenti</h3>
Â  Â  Â  Â <div id="recent-activity" class="space-y-3">
Â  Â  Â  Â  <p class="text-gray-500 text-center py-8">Nessuna attivitÃ  recente</p>
Â  Â  Â  Â </div>
Â  Â  Â  </div>Â  Â  Â  <div id="csirt-dashboard-cards">
Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">Â  Â  Â  Â  <div class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow cursor-pointer border-t-4 border-red-500" onclick="openIncidentsDetail()">
Â  Â  Â  Â  Â <div class="p-6">
Â  Â  Â  Â  Â  <div class="flex items-center justify-between mb-4">
Â  Â  Â  Â  Â  Â <div class="bg-red-100 p-3 rounded-full">
Â  Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â </div><span class="text-3xl font-bold text-red-600" id="incident-count">0</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <h3 class="text-xl font-bold text-gray-800 mb-2">ğŸš¨ Registro Incidenti</h3>
Â  Â  Â  Â  Â  <p class="text-gray-600 text-sm">Gestisci e traccia gli incidenti di sicurezza secondo NIS2</p>
Â  Â  Â  Â  Â  <div class="mt-4 pt-4 border-t border-gray-200"><button onclick="openIncidentsDetail()" class="w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium"> Apri Registro â†’ </button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow cursor-pointer border-t-4 border-purple-500" onclick="openDesignationDetail()">
Â  Â  Â  Â  Â <div class="p-6">
Â  Â  Â  Â  Â  <div class="flex items-center justify-between mb-4">
Â  Â  Â  Â  Â  Â <div class="bg-purple-100 p-3 rounded-full">
Â  Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â </div><span class="text-sm font-medium text-purple-600" id="designation-status">Non compilato</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <h3 class="text-xl font-bold text-gray-800 mb-2">ğŸ“‹ Designazione CSIRT</h3>
Â  Â  Â  Â  Â  <p class="text-gray-600 text-sm">Compila i dati del referente CSIRT e sostituti</p>
Â  Â  Â  Â  Â  <div class="mt-4 pt-4 border-t border-gray-200"><button onclick="openDesignationDetail()" class="w-full px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm font-medium"> Apri Designazione â†’ </button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow cursor-pointer border-t-4 border-blue-500" onclick="openNetworkDetail()">
Â  Â  Â  Â  Â <div class="p-6">
Â  Â  Â  Â  Â  <div class="flex items-center justify-between mb-4">
Â  Â  Â  Â  Â  Â <div class="bg-blue-100 p-3 rounded-full">
Â  Â  Â  Â  Â  Â  <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â </div><span class="text-sm font-medium text-blue-600" id="network-status">Non configurato</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <h3 class="text-xl font-bold text-gray-800 mb-2">ğŸŒ Configurazione Rete</h3>
Â  Â  Â  Â  Â  <p class="text-gray-600 text-sm">Definisci architettura, sicurezza e monitoraggio rete</p>
Â  Â  Â  Â  Â  <div class="mt-4 pt-4 border-t border-gray-200"><button onclick="openNetworkDetail()" class="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium"> Apri Configurazione â†’ </button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>
Â  Â  Â  </div>
Â  Â  Â </section>
Â  Â  Â Â  Â  Â <section id="designation-detail-section" class="section-content hidden">
Â  Â  Â  <div class="mb-6 flex items-center space-x-4"><button onclick="showSection('dashboard')" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
Â  Â  Â  Â  </svg><span>Torna alla Dashboard</span> </button>
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800">ğŸ“‹ Designazione Referente CSIRT</h2>
Â  Â  Â  </div>
Â  Â  Â  <div class="bg-white rounded-xl shadow-md p-6">
Â  Â  Â  Â <div class="mb-6">
Â  Â  Â  Â  <h3 class="text-2xl font-bold text-gray-800 mb-2">ğŸ“‹ Designazione Referente CSIRT</h3>
Â  Â  Â  Â  <p class="text-gray-600">Compila i dati del referente CSIRT, sostituti e informazioni di contatto con ACN</p>
Â  Â  Â  Â </div>
Â  Â  Â  Â <form id="designation-form" onsubmit="saveDesignation(event)">
Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-purple-500">ğŸ¢ Dati Azienda</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Ragione Sociale *</label> <input type="text" id="des-company-name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Partita IVA *</label> <input type="text" id="des-company-vat" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Codice Fiscale</label> <input type="text" id="des-company-cf" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Settore AttivitÃ  *</label> <select id="des-company-sector" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona settore</option> <option value="energia">Energia</option> <option value="trasporti">Trasporti</option> <option value="bancario">Settore Bancario</option> <option value="sanitario">SanitÃ </option> <option value="ict">ICT</option> <option value="pubblica-amministrazione">Pubblica Amministrazione</option> <option value="altro">Altro</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Indirizzo Sede Legale *</label> <input type="text" id="des-company-address" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-purple-500">ğŸ‘¤ Referente CSIRT Principale</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Nome *</label> <input type="text" id="des-main-name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Cognome *</label> <input type="text" id="des-main-surname" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Codice Fiscale *</label> <input type="text" id="des-main-cf" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Ruolo in Azienda *</label> <input type="text" id="des-main-role" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Email *</label> <input type="email" id="des-main-email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Telefono *</label> <input type="tel" id="des-main-phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">PEC</label> <input type="email" id="des-main-pec" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-purple-500">ğŸ‘¥ Sostituto 1</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Nome</label> <input type="text" id="des-sub1-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Cognome</label> <input type="text" id="des-sub1-surname" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Codice Fiscale</label> <input type="text" id="des-sub1-cf" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Ruolo in Azienda</label> <input type="text" id="des-sub1-role" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Email</label> <input type="email" id="des-sub1-email" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Telefono</label> <input type="tel" id="des-sub1-phone" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-purple-500">ğŸ‘¥ Sostituto 2</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Nome</label> <input type="text" id="des-sub2-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Cognome</label> <input type="text" id="des-sub2-surname" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Codice Fiscale</label> <input type="text" id="des-sub2-cf" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Ruolo in Azienda</label> <input type="text" id="des-sub2-role" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Email</label> <input type="email" id="des-sub2-email" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Telefono</label> <input type="tel" id="des-sub2-phone" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-purple-500">ğŸ“ Contatto con ACN</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Email Registrata ACN</label> <input type="email" id="des-acn-email" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">PEC Comunicazioni ACN</label> <input type="email" id="des-acn-pec" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Telefono Emergenze</label> <input type="tel" id="des-acn-phone" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Data Registrazione Portale ACN</label> <input type="date" id="des-acn-registration-date" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Note Aggiuntive</label> <textarea id="des-notes" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="flex justify-between items-center pt-6 border-t"><button type="button" onclick="generateDesignationDoc()" class="px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
Â  Â  Â  Â  Â  </svg><span>Genera Documento Word</span> </button>
Â  Â  Â  Â  Â <div class="flex space-x-4"><button type="button" onclick="resetDesignationForm()" class="px-6 py-3 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg"> Annulla </button> <button type="submit" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
Â  Â  Â  Â  Â  Â </svg><span>Salva Designazione</span> </button>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </form>
Â  Â  Â  </div>
Â  Â  Â </section>Â  Â  Â <section id="network-detail-section" class="section-content hidden">
Â  Â  Â  <div class="mb-6 flex items-center space-x-4"><button onclick="showSection('dashboard')" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg flex items-center space-x-2">
Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
Â  Â  Â  Â </svg><span>Torna alla Dashboard</span> </button>
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800">ğŸŒ Configurazione Rete Aziendale</h2>
Â  Â  Â </div>
Â  Â  Â <div class="bg-white rounded-xl shadow-md">
Â  Â  Â  <div class="flex border-b border-gray-200"><button onclick="switchNetworkTab('visualization')" id="network-tab-visualization" class="network-tab px-6 py-4 font-medium text-blue-600 border-b-2 border-blue-600"> ğŸ“Š Visualizzazione Rete </button> <button onclick="switchNetworkTab('configuration')" id="network-tab-configuration" class="network-tab px-6 py-4 font-medium text-gray-500 hover:text-gray-700"> âš™ï¸ Configurazione Wizard </button>
Â  Â  Â  </div>Â  Â  Â  <div id="network-subcontent-visualization" class="network-tab-content p-6">Â  Â  Â  Â <div id="network-visualization" class="mb-8 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-8 border-2 border-gray-200">
Â  Â  Â  Â  <h4 class="text-xl font-bold text-gray-800 mb-6 text-center">ğŸ“Š Diagramma Architettura Rete</h4>Â  Â  Â  Â  <svg id="network-diagram" viewbox="0 0 800 600" class="w-full h-auto"><g id="internet-cloud">
Â  Â  Â  Â  Â  <ellipse cx="400" cy="80" rx="80" ry="50" fill="#3b82f6" opacity="0.2" stroke="#3b82f6" stroke-width="2" />
Â  Â  Â  Â  Â  <text x="400" y="85" text-anchor="middle" fill="#1e40af" font-weight="bold" font-size="14">
Â  Â  Â  Â  Â  Â â˜ï¸ INTERNET
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â </g> <line x1="400" y1="130" x2="400" y2="180" stroke="#6b7280" stroke-width="2" stroke-dasharray="5,5" /> <g id="firewall">
Â  Â  Â  Â  Â  <rect x="350" y="180" width="100" height="60" rx="8" fill="#ef4444" opacity="0.2" stroke="#ef4444" stroke-width="2" />
Â  Â  Â  Â  Â  <text x="400" y="205" text-anchor="middle" fill="#991b1b" font-weight="bold" font-size="12">
Â  Â  Â  Â  Â  Â ğŸ›¡ï¸ FIREWALL
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <text x="400" y="225" text-anchor="middle" fill="#991b1b" font-size="10" id="firewall-label">
Â  Â  Â  Â  Â  Â NGF
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â </g> <line x1="400" y1="240" x2="400" y2="280" stroke="#6b7280" stroke-width="2" /> <line x1="400" y1="280" x2="250" y2="350" stroke="#6b7280" stroke-width="2" /> <line x1="400" y1="280" x2="400" y2="350" stroke="#6b7280" stroke-width="2" /> <line x1="400" y1="280" x2="550" y2="350" stroke="#6b7280" stroke-width="2" /> <g id="vlan-admin">
Â  Â  Â  Â  Â  <rect x="150" y="350" width="200" height="200" rx="12" fill="#8b5cf6" opacity="0.1" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="8,4" />
Â  Â  Â  Â  Â  <text x="250" y="375" text-anchor="middle" fill="#6b21a8" font-weight="bold" font-size="12">
Â  Â  Â  Â  Â  Â VLAN 10 - Admin
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="180" y="390" width="60" height="50" rx="4" fill="#8b5cf6" opacity="0.3" stroke="#8b5cf6" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="210" y="420" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ’»
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="260" y="390" width="60" height="50" rx="4" fill="#8b5cf6" opacity="0.3" stroke="#8b5cf6" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="290" y="420" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ’»
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="180" y="460" width="60" height="50" rx="4" fill="#8b5cf6" opacity="0.3" stroke="#8b5cf6" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="210" y="490" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ–¥ï¸
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="260" y="460" width="60" height="50" rx="4" fill="#8b5cf6" opacity="0.3" stroke="#8b5cf6" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="290" y="490" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ–¥ï¸
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â </g> <g id="vlan-production">
Â  Â  Â  Â  Â  <rect x="450" y="350" width="200" height="200" rx="12" fill="#10b981" opacity="0.1" stroke="#10b981" stroke-width="2" stroke-dasharray="8,4" />
Â  Â  Â  Â  Â  <text x="550" y="375" text-anchor="middle" fill="#047857" font-weight="bold" font-size="12">
Â  Â  Â  Â  Â  Â VLAN 20 - Produzione
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="480" y="390" width="60" height="50" rx="4" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="510" y="420" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ–¥ï¸
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="560" y="390" width="60" height="50" rx="4" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="590" y="420" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ–¥ï¸
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="480" y="460" width="60" height="50" rx="4" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="510" y="490" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ’¼
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="560" y="460" width="60" height="50" rx="4" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="590" y="490" text-anchor="middle" font-size="20">
Â  Â  Â  Â  Â  Â ğŸ“Š
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â </g> <g id="vlan-dmz">
Â  Â  Â  Â  Â  <rect x="300" y="350" width="200" height="120" rx="12" fill="#f59e0b" opacity="0.1" stroke="#f59e0b" stroke-width="2" stroke-dasharray="8,4" />
Â  Â  Â  Â  Â  <text x="400" y="375" text-anchor="middle" fill="#b45309" font-weight="bold" font-size="12">
Â  Â  Â  Â  Â  Â DMZ - Zona Pubblica
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="330" y="390" width="60" height="60" rx="4" fill="#f59e0b" opacity="0.3" stroke="#f59e0b" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="360" y="425" text-anchor="middle" font-size="24">
Â  Â  Â  Â  Â  Â ğŸŒ
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <text x="360" y="445" text-anchor="middle" font-size="8">
Â  Â  Â  Â  Â  Â Web Server
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <rect x="410" y="390" width="60" height="60" rx="4" fill="#f59e0b" opacity="0.3" stroke="#f59e0b" stroke-width="1" />
Â  Â  Â  Â  Â  <text x="440" y="425" text-anchor="middle" font-size="24">
Â  Â  Â  Â  Â  Â ğŸ“§
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â  <text x="440" y="445" text-anchor="middle" font-size="8">
Â  Â  Â  Â  Â  Â Mail Server
Â  Â  Â  Â  Â  </text>
Â  Â  Â  Â  Â </g>
Â  Â  Â  Â  </svg>Â  Â  Â  Â  <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
Â  Â  Â  Â  Â <div class="bg-white rounded-lg p-4 text-center shadow">
Â  Â  Â  Â  Â  <div class="text-2xl font-bold text-blue-600" id="stat-sites">
Â  Â  Â  Â  Â  Â -
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="text-xs text-gray-600">
Â  Â  Â  Â  Â  Â Sedi
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â <div class="bg-white rounded-lg p-4 text-center shadow">
Â  Â  Â  Â  Â  <div class="text-2xl font-bold text-green-600" id="stat-users">
Â  Â  Â  Â  Â  Â -
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="text-xs text-gray-600">
Â  Â  Â  Â  Â  Â Utenti
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â <div class="bg-white rounded-lg p-4 text-center shadow">
Â  Â  Â  Â  Â  <div class="text-2xl font-bold text-purple-600" id="stat-vlans">
Â  Â  Â  Â  Â  Â -
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="text-xs text-gray-600">
Â  Â  Â  Â  Â  Â VLAN
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â <div class="bg-white rounded-lg p-4 text-center shadow">
Â  Â  Â  Â  Â  <div class="text-2xl font-bold text-orange-600" id="stat-security">
Â  Â  Â  Â  Â  Â -
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="text-xs text-gray-600">
Â  Â  Â  Â  Â  Â Livello Sicurezza
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>Â  Â  Â  Â <div id="network-subcontent-configuration" class="network-tab-content hidden p-6">
Â  Â  Â  Â  <p class="text-gray-600 mb-6">Utilizza il wizard per configurare l'architettura di rete aziendale in 5 step</p><button onclick="showSection('network')" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
Â  Â  Â  Â  Â </svg><span>Apri Configurazione Wizard</span> </button>
Â  Â  Â  Â </div>
Â  Â  Â  </div>
Â  Â  Â </section> Â  Â  Â <section id="companies-section" class="section-content hidden">
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800 mb-2">ğŸ¢ Gestione Aziende</h2>
Â  Â  Â  <p class="text-gray-600 mb-6">Gestisci le aziende registrate sulla piattaforma e monitora il loro stato di compliance</p>
Â  Â  Â  <div class="bg-white rounded-xl shadow-md p-6 mb-6">
Â  Â  Â  Â <div class="flex justify-between items-center mb-6">
Â  Â  Â  Â  <div class="flex space-x-4"><input type="text" id="search-companies" placeholder="ğŸ” Cerca aziende..." class="px-4 py-2 border border-gray-300 rounded-lg w-64" oninput="filterCompanies()"> <select id="filter-company-status" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterCompanies()"> <option value="">Tutti gli stati</option> <option value="attivo">Attivo</option> <option value="sospeso">Sospeso</option> <option value="in-valutazione">In Valutazione</option> </select>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="flex space-x-3"><button onclick="exportCompanies()" class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
Â  Â  Â  Â  Â  </svg><span>Esporta Excel</span> </button> <button onclick="openAddCompanyModal()" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
Â  Â  Â  Â  Â  </svg><span>Nuova Azienda</span> </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>Â  Â  Â  Â <div class="overflow-x-auto">
Â  Â  Â  Â  <table class="w-full">
Â  Â  Â  Â  Â <thead class="bg-gray-50 border-b-2 border-gray-200">
Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Azienda</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">P.IVA</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Settore</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dipendenti</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Referente</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contatti</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Compliance</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stato</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Azioni</th>
Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â </thead>
Â  Â  Â  Â  Â <tbody id="companies-table-body" class="bg-white divide-y divide-gray-200">Â  Â  Â  Â  Â </tbody>
Â  Â  Â  Â  </table>
Â  Â  Â  Â </div>
Â  Â  Â  </div>
Â  Â  Â </section>Â  Â  Â <section id="users-section" class="section-content hidden">
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800 mb-2">ğŸ‘¥ Gestione Utenti</h2>
Â  Â  Â  <p class="text-gray-600 mb-6">Gestisci gli utenti della piattaforma e i loro permessi</p>
Â  Â  Â  <div class="bg-white rounded-xl shadow-md p-6 mb-6">
Â  Â  Â  Â <div class="flex justify-between items-center mb-6">
Â  Â  Â  Â  <div class="flex space-x-4"><input type="text" id="search-users" placeholder="ğŸ” Cerca utenti..." class="px-4 py-2 border border-gray-300 rounded-lg w-64" oninput="filterUsers()"> <select id="filter-user-role" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterUsers()"> <option value="">Tutti i ruoli</option> <option value="admin">Amministratore</option> <option value="csirt">Consulente CSIRT</option> <option value="azienda">Referente Aziendale</option> </select> <select id="filter-user-status" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterUsers()"> <option value="">Tutti gli stati</option> <option value="attivo">Attivo</option> <option value="sospeso">Sospeso</option> </select>
Â  Â  Â  Â  </div><button onclick="openAddUserModal()" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
Â  Â  Â  Â  Â </svg><span>Nuovo Utente</span> </button>
Â  Â  Â  Â </div>
Â  Â  Â  Â <div class="overflow-x-auto">
Â  Â  Â  Â  <table class="w-full">
Â  Â  Â  Â  Â <thead class="bg-gray-50 border-b-2 border-gray-200">
Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Utente</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ruolo</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Azienda</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stato</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ultimo Accesso</th>
Â  Â  Â  Â  Â  Â <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Azioni</th>
Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â </thead>
Â  Â  Â  Â  Â <tbody id="users-table-body" class="bg-white divide-y divide-gray-200">Â  Â  Â  Â  Â </tbody>
Â  Â  Â  Â  </table>
Â  Â  Â  Â </div>
Â  Â  Â  </div>
Â  Â  Â </section>Â  Â  Â <section id="notifications-section" class="section-content hidden">
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800 mb-6">Notifiche ACN</h2>
Â  Â  Â  <div class="bg-white rounded-xl shadow-md p-6">
Â  Â  Â  Â <p class="text-gray-600">Sezione notifiche in costruzione...</p>
Â  Â  Â  </div>
Â  Â  Â </section>Â  Â  Â <section id="incidents-section" class="section-content hidden">
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800 mb-2">ğŸš¨ Registro Incidenti di Sicurezza</h2>
Â  Â  Â  <p class="text-gray-600 mb-6">Documenta e traccia tutti gli incidenti secondo i requisiti NIS2</p>Â  Â  Â  <div class="bg-white rounded-t-xl shadow-md">
Â  Â  Â  Â <div class="flex border-b border-gray-200"><button onclick="switchIncidentTab('list')" id="tab-list" class="incident-tab px-6 py-4 font-medium text-blue-600 border-b-2 border-blue-600"> ğŸ“‹ Lista Incidenti </button> <button onclick="switchIncidentTab('new')" id="tab-new" class="incident-tab px-6 py-4 font-medium text-gray-500 hover:text-gray-700"> â• Nuovo Incidente </button> <button onclick="switchIncidentTab('drafts')" id="tab-drafts" class="incident-tab px-6 py-4 font-medium text-gray-500 hover:text-gray-700"> ğŸ’¾ Bozze </button>
Â  Â  Â  Â </div>
Â  Â  Â  </div>Â  Â  Â  <div id="incident-tab-list" class="incident-tab-content bg-white rounded-b-xl shadow-md p-6">
Â  Â  Â  Â <div class="flex justify-between items-center mb-6">
Â  Â  Â  Â  <div class="flex space-x-4"><input type="text" id="search-incidents" placeholder="ğŸ” Cerca incidenti..." class="px-4 py-2 border border-gray-300 rounded-lg w-64"> <select id="filter-status" class="px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Tutti gli stati</option> <option value="aperto">Aperto</option> <option value="in-corso">In Corso</option> <option value="risolto">Risolto</option> </select>
Â  Â  Â  Â  </div><button onclick="exportIncidents()" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
Â  Â  Â  Â  Â </svg><span>Esporta</span> </button>
Â  Â  Â  Â </div>
Â  Â  Â  Â <div id="incidents-list" class="space-y-4">
Â  Â  Â  Â  <p class="text-center text-gray-500 py-8">Nessun incidente registrato</p>
Â  Â  Â  Â </div>
Â  Â  Â  </div>Â  Â  Â  <div id="incident-tab-new" class="incident-tab-content hidden bg-white rounded-b-xl shadow-md p-6">
Â  Â  Â  Â <form id="incident-form" onsubmit="saveIncident(event)">Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-blue-500">ğŸ“‹ Dati Generali Incidente</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Titolo Incidente *</label> <input type="text" id="incident-title" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Data/Ora Rilevamento *</label> <input type="datetime-local" id="incident-datetime" required class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">GravitÃ  *</label> <select id="incident-severity" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona gravitÃ </option> <option value="critical">ğŸ”´ Critica</option> <option value="high">ğŸŸ  Alta</option> <option value="medium">ğŸŸ¡ Media</option> <option value="low">ğŸ”µ Bassa</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Stato *</label> <select id="incident-status" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="aperto">Aperto</option> <option value="in-corso">In Corso</option> <option value="risolto">Risolto</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Descrizione Incidente *</label> <textarea id="incident-description" required rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-blue-500">ğŸ·ï¸ Categorizzazione</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Tipo Incidente *</label> <select id="incident-type" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona tipo</option> <option value="malware">Malware</option> <option value="phishing">Phishing</option> <option value="ddos">DDoS</option> <option value="data-breach">Data Breach</option> <option value="ransomware">Ransomware</option> <option value="accesso-non-autorizzato">Accesso Non Autorizzato</option> <option value="altro">Altro</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Servizio/Asset Colpito</label> <input type="text" id="incident-asset" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-blue-500">ğŸ’¥ Impatto dell'Incidente</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Numero Utenti Coinvolti</label> <input type="number" id="incident-users" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Durata Interruzione (ore)</label> <input type="number" id="incident-duration" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Descrizione Impatto</label> <textarea id="incident-impact" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="md:col-span-2"><label class="flex items-center space-x-2"> <input type="checkbox" id="incident-data-loss" class="w-4 h-4 text-blue-600"> <span class="text-sm font-medium text-gray-700">Perdita/Compromissione Dati</span> </label>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-blue-500">ğŸ› ï¸ Azioni Intraprese</h3>
Â  Â  Â  Â  Â <div class="space-y-4">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Misure di Contenimento</label> <textarea id="incident-containment" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="Descrivere le azioni immediate per contenere l'incidente"></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Azioni Correttive</label> <textarea id="incident-corrective" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="Descrivere le azioni per risolvere l'incidente"></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Raccomandazioni Future</label> <textarea id="incident-recommendations" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="Raccomandazioni per prevenire incidenti simili"></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="mb-8">
Â  Â  Â  Â  Â <h3 class="text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-blue-500">ğŸ“¢ Notifica ACN</h3>
Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  <div><label class="flex items-center space-x-2 mb-4"> <input type="checkbox" id="incident-acn-required" class="w-4 h-4 text-blue-600" onchange="toggleACNFields()"> <span class="text-sm font-medium text-gray-700">Richiede Notifica ACN</span> </label>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div></div>
Â  Â  Â  Â  Â  <div id="acn-fields" class="md:col-span-2 hidden space-y-4">
Â  Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Data Notifica Iniziale</label> <input type="datetime-local" id="incident-acn-date-initial" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Data Notifica Intermedia</label> <input type="datetime-local" id="incident-acn-date-intermediate" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Data Notifica Finale</label> <input type="datetime-local" id="incident-acn-date-final" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Numero Protocollo ACN</label> <input type="text" id="incident-acn-protocol" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Note Comunicazione ACN</label> <textarea id="incident-acn-notes" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="flex justify-between items-center pt-6 border-t"><button type="button" onclick="saveDraft()" class="px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
Â  Â  Â  Â  Â  </svg><span>Salva Bozza</span> </button>
Â  Â  Â  Â  Â <div class="flex space-x-4"><button type="button" onclick="resetIncidentForm()" class="px-6 py-3 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg"> Annulla </button> <button type="submit" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
Â  Â  Â  Â  Â  Â </svg><span>Salva Incidente</span> </button>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </form>
Â  Â  Â  </div>Â  Â  Â  <div id="incident-tab-drafts" class="incident-tab-content hidden bg-white rounded-b-xl shadow-md p-6">
Â  Â  Â  Â <div id="drafts-list" class="space-y-4">
Â  Â  Â  Â  <p class="text-center text-gray-500 py-8">Nessuna bozza salvata</p>
Â  Â  Â  Â </div>
Â  Â  Â  </div>
Â  Â  Â </section>Â  Â  Â <section id="network-section" class="section-content hidden">
Â  Â  Â  <h2 class="text-3xl font-bold text-gray-800 mb-2">ğŸŒ Configurazione Rete Aziendale</h2>
Â  Â  Â  <p class="text-gray-600 mb-6">Definisci l'architettura di rete, sicurezza perimetrale e connettivitÃ  secondo NIS2</p>
Â  Â  Â  <div class="bg-white rounded-xl shadow-md p-6">Â  Â  Â  Â <div class="mb-8">
Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â <div class="flex-1">
Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â <div id="step-indicator-1" class="step-indicator active flex items-center justify-center w-10 h-10 rounded-full bg-blue-600 text-white font-bold">
Â  Â  Â  Â  Â  Â  1
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="flex-1 h-1 bg-gray-300 mx-2"></div>
Â  Â  Â  Â  Â  Â <div id="step-indicator-2" class="step-indicator flex items-center justify-center w-10 h-10 rounded-full bg-gray-300 text-gray-600 font-bold">
Â  Â  Â  Â  Â  Â  2
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="flex-1 h-1 bg-gray-300 mx-2"></div>
Â  Â  Â  Â  Â  Â <div id="step-indicator-3" class="step-indicator flex items-center justify-center w-10 h-10 rounded-full bg-gray-300 text-gray-600 font-bold">
Â  Â  Â  Â  Â  Â  3
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="flex-1 h-1 bg-gray-300 mx-2"></div>
Â  Â  Â  Â  Â  Â <div id="step-indicator-4" class="step-indicator flex items-center justify-center w-10 h-10 rounded-full bg-gray-300 text-gray-600 font-bold">
Â  Â  Â  Â  Â  Â  4
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="flex-1 h-1 bg-gray-300 mx-2"></div>
Â  Â  Â  Â  Â  Â <div id="step-indicator-5" class="step-indicator flex items-center justify-center w-10 h-10 rounded-full bg-gray-300 text-gray-600 font-bold">
Â  Â  Â  Â  Â  Â  5
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="flex justify-between mt-2 text-xs text-gray-600"><span>Topologia</span> <span>Sicurezza</span> <span>ConnettivitÃ </span> <span>Monitoraggio</span> <span>Riepilogo</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </div>
Â  Â  Â  Â <form id="network-form" onsubmit="saveNetworkConfig(event)">Â  Â  Â  Â  <div id="network-step-1" class="network-step">
Â  Â  Â  Â  Â <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ”· Step 1: Topologia Rete</h3>
Â  Â  Â  Â  Â <div class="space-y-6">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Tipologia Rete *</label> <select id="net-topology-type" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona tipologia</option> <option value="lan">LAN (Local Area Network)</option> <option value="wan">WAN (Wide Area Network)</option> <option value="hybrid">Ibrida (LAN + WAN)</option> <option value="cloud">Cloud-Based</option> <option value="sdwan">SD-WAN</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Numero Sedi *</label> <input type="number" id="net-sites-count" required min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Numero Utenti Totali *</label> <input type="number" id="net-users-count" required min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Segmentazione Rete *</label> <select id="net-segmentation" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona livello segmentazione</option> <option value="none">Nessuna segmentazione</option> <option value="basic">Base (VLAN separate)</option> <option value="advanced">Avanzata (DMZ, Zone trusted/untrusted)</option> <option value="zero-trust">Zero Trust Architecture</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">VLAN Configurate</label> <textarea id="net-vlans" rows="3" placeholder="Es: VLAN 10 - Amministrazione, VLAN 20 - Produzione, VLAN 30 - DMZ" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Indirizzamento IP *</label>
Â  Â  Â  Â  Â  Â <div class="space-y-2"><label class="flex items-center space-x-2"> <input type="radio" name="ip-addressing" value="ipv4" required class="w-4 h-4 text-blue-600"> <span>Solo IPv4</span> </label> <label class="flex items-center space-x-2"> <input type="radio" name="ip-addressing" value="ipv6" class="w-4 h-4 text-blue-600"> <span>Solo IPv6</span> </label> <label class="flex items-center space-x-2"> <input type="radio" name="ip-addressing" value="dual-stack" class="w-4 h-4 text-blue-600"> <span>Dual Stack (IPv4 + IPv6)</span> </label>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Range IP Principali</label> <input type="text" id="net-ip-ranges" placeholder="Es: 192.168.1.0/24, 10.0.0.0/16" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div id="network-step-2" class="network-step hidden">
Â  Â  Â  Â  Â <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ›¡ï¸ Step 2: Sicurezza Perimetrale</h3>
Â  Â  Â  Â  Â <div class="space-y-6">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Firewall Perimetrale *</label> <select id="net-firewall-type" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona tipo firewall</option> <option value="hardware">Hardware Dedicato</option> <option value="software">Software/Virtual</option> <option value="ngfw">Next-Generation Firewall (NGFW)</option> <option value="cloud">Cloud-based (FWaaS)</option> <option value="none">Nessun firewall</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Marca/Modello Firewall</label> <input type="text" id="net-firewall-model" placeholder="Es: Fortinet FortiGate 100F, Cisco ASA 5506" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-3">FunzionalitÃ  Firewall Attive</label>
Â  Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-3"><label class="flex items-center space-x-2"> <input type="checkbox" id="fw-stateful" class="w-4 h-4 text-blue-600"> <span class="text-sm">Stateful Inspection</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="fw-ips" class="w-4 h-4 text-blue-600"> <span class="text-sm">IPS/IDS</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="fw-av" class="w-4 h-4 text-blue-600"> <span class="text-sm">Antivirus Gateway</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="fw-web-filter" class="w-4 h-4 text-blue-600"> <span class="text-sm">Web Filtering</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="fw-app-control" class="w-4 h-4 text-blue-600"> <span class="text-sm">Application Control</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="fw-ssl-inspect" class="w-4 h-4 text-blue-600"> <span class="text-sm">SSL/TLS Inspection</span> </label>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Sistema WAF (Web Application Firewall) *</label> <select id="net-waf" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="yes-dedicated">SÃ¬ - WAF Dedicato</option> <option value="yes-integrated">SÃ¬ - Integrato nel Firewall</option> <option value="yes-cloud">SÃ¬ - Cloud WAF (es. Cloudflare, AWS WAF)</option> <option value="no">No - Non implementato</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Antimalware/EDR *</label> <select id="net-antimalware" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="edr">EDR (Endpoint Detection &amp; Response)</option> <option value="traditional">Antivirus Tradizionale</option> <option value="xdr">XDR (Extended Detection &amp; Response)</option> <option value="none">Nessuno</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Soluzione Antimalware Utilizzata</label> <input type="text" id="net-antimalware-product" placeholder="Es: CrowdStrike Falcon, Microsoft Defender ATP" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Email Security Gateway *</label> <select id="net-email-security" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="yes-dedicated">SÃ¬ - Gateway Dedicato</option> <option value="yes-cloud">SÃ¬ - Cloud-based (es. Proofpoint, Mimecast)</option> <option value="basic">Protezione base provider email</option> <option value="no">Nessuna protezione avanzata</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div id="network-step-3" class="network-step hidden">
Â  Â  Â  Â  Â <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ”Œ Step 3: ConnettivitÃ  e Accessi</h3>
Â  Â  Â  Â  Â <div class="space-y-6">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">ConnettivitÃ  Internet *</label> <select id="net-internet-type" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona tipo connessione</option> <option value="fiber">Fibra Ottica</option> <option value="adsl">ADSL/VDSL</option> <option value="leased-line">Linea Dedicata</option> <option value="4g-5g">4G/5G</option> <option value="satellite">Satellite</option> <option value="redundant">Ridondante (Multipli ISP)</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Provider Internet</label> <input type="text" id="net-isp" placeholder="Es: TIM, Vodafone, Fastweb" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Banda Download (Mbps)</label> <input type="number" id="net-bandwidth-down" placeholder="Es: 1000" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div><label class="block text-sm font-medium text-gray-700 mb-2">Banda Upload (Mbps)</label> <input type="number" id="net-bandwidth-up" placeholder="Es: 300" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">VPN Configurata *</label> <select id="net-vpn-type" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="site-to-site">Site-to-Site VPN</option> <option value="remote-access">Remote Access VPN</option> <option value="both">Entrambe (Site-to-Site + Remote Access)</option> <option value="ssl-vpn">SSL VPN</option> <option value="ipsec">IPsec VPN</option> <option value="none">Nessuna VPN</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Soluzione VPN Utilizzata</label> <input type="text" id="net-vpn-solution" placeholder="Es: Cisco AnyConnect, OpenVPN, FortiClient" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Autenticazione Multifattore (MFA) *</label> <select id="net-mfa" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="yes-all">SÃ¬ - Tutti gli accessi remoti</option> <option value="yes-critical">SÃ¬ - Solo sistemi critici</option> <option value="yes-admin">SÃ¬ - Solo account amministrativi</option> <option value="no">No - Non implementata</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Soluzione MFA</label> <input type="text" id="net-mfa-solution" placeholder="Es: Microsoft Authenticator, Google Authenticator, Duo Security" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Wi-Fi Aziendale *</label> <select id="net-wifi" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="yes-segmented">SÃ¬ - Reti separate (Corporate/Guest)</option> <option value="yes-single">SÃ¬ - Rete singola</option> <option value="yes-wpa3">SÃ¬ - Con WPA3</option> <option value="no">No Wi-Fi</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Autenticazione Wi-Fi Aziendale</label> <select id="net-wifi-auth" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="wpa3-enterprise">WPA3-Enterprise (802.1X)</option> <option value="wpa2-enterprise">WPA2-Enterprise (802.1X)</option> <option value="wpa2-psk">WPA2-PSK</option> <option value="captive-portal">Captive Portal</option> <option value="open">Aperta (non raccomandato)</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div id="network-step-4" class="network-step hidden">
Â  Â  Â  Â  Â <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“Š Step 4: Monitoraggio e Logging</h3>
Â  Â  Â  Â  Â <div class="space-y-6">
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">SIEM (Security Information &amp; Event Management) *</label> <select id="net-siem" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="yes-dedicated">SÃ¬ - SIEM Dedicato</option> <option value="yes-cloud">SÃ¬ - Cloud SIEM (es. Splunk Cloud, Azure Sentinel)</option> <option value="basic-logging">Logging centralizzato base</option> <option value="no">Nessun SIEM</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Soluzione SIEM/Log Management</label> <input type="text" id="net-siem-product" placeholder="Es: Splunk, QRadar, Elastic SIEM, Azure Sentinel" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Retention Log (giorni) *</label> <input type="number" id="net-log-retention" required min="1" placeholder="Es: 365" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  Â <p class="text-xs text-gray-500 mt-1">NIS2 richiede almeno 6 mesi (180 giorni)</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-3">Tipologie di Log Raccolti *</label>
Â  Â  Â  Â  Â  Â <div class="grid grid-cols-1 md:grid-cols-2 gap-3"><label class="flex items-center space-x-2"> <input type="checkbox" id="log-firewall" class="w-4 h-4 text-blue-600"> <span class="text-sm">Firewall</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="log-authentication" class="w-4 h-4 text-blue-600"> <span class="text-sm">Autenticazione</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="log-vpn" class="w-4 h-4 text-blue-600"> <span class="text-sm">VPN</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="log-email" class="w-4 h-4 text-blue-600"> <span class="text-sm">Email Gateway</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="log-web" class="w-4 h-4 text-blue-600"> <span class="text-sm">Web Proxy</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="log-dns" class="w-4 h-4 text-blue-600"> <span class="text-sm">DNS</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="log-dhcp" class="w-4 h-4 text-blue-600"> <span class="text-sm">DHCP</span> </label> <label class="flex items-center space-x-2"> <input type="checkbox" id="log-endpoints" class="w-4 h-4 text-blue-600"> <span class="text-sm">Endpoint (EDR)</span> </label>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Monitoraggio Network in Tempo Reale *</label> <select id="net-monitoring" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="yes-24x7">SÃ¬ - 24x7 con SOC</option> <option value="yes-automated">SÃ¬ - Automatizzato con alerting</option> <option value="yes-business-hours">SÃ¬ - Solo orario lavorativo</option> <option value="basic">Base - Controlli periodici</option> <option value="no">Nessun monitoraggio attivo</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Tool di Network Monitoring</label> <input type="text" id="net-monitoring-tool" placeholder="Es: PRTG, Nagios, Zabbix, SolarWinds" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Vulnerability Assessment *</label> <select id="net-vulnerability-scan" required class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Seleziona</option> <option value="continuous">Continuo</option> <option value="monthly">Mensile</option> <option value="quarterly">Trimestrale</option> <option value="yearly">Annuale</option> <option value="none">Mai eseguito</option> </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div><label class="block text-sm font-medium text-gray-700 mb-2">Tool Vulnerability Scanning</label> <input type="text" id="net-vuln-tool" placeholder="Es: Nessus, Qualys, OpenVAS, Rapid7" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div id="network-step-5" class="network-step hidden">
Â  Â  Â  Â  Â <h3 class="text-2xl font-bold text-gray-800 mb-6">âœ… Step 5: Riepilogo Configurazione</h3>
Â  Â  Â  Â  Â <div id="network-summary" class="space-y-6">Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>Â  Â  Â  Â  <div class="flex justify-between items-center pt-6 border-t mt-8"><button type="button" id="network-prev-btn" onclick="previousNetworkStep()" class="px-6 py-3 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg hidden"> â† Indietro </button>
Â  Â  Â  Â  Â <div class="flex space-x-4 ml-auto"><button type="button" onclick="resetNetworkForm()" class="px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg"> Reset </button> <button type="button" id="network-next-btn" onclick="nextNetworkStep()" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg"> Avanti â†’ </button> <button type="submit" id="network-submit-btn" class="hidden px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center space-x-2">
Â  Â  Â  Â  Â  Â <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
Â  Â  Â  Â  Â  Â </svg><span>Salva Configurazione</span> </button>
Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â </form>
Â  Â  Â  </div>
Â  Â  Â </section>
Â  Â  </div>
Â  Â </div>
Â  Â <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
Â  Â <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
Â  Â <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
Â  Â <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
Â  Â <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

Â  Â <script>
Â  Â  // === GLOBAL STATE ===
Â  Â  let currentUser = null;

Â  Â  const DEMO_USERS = [
Â  Â  Â  { email: 'admin@csirt.it', password: 'admin123', role: 'admin', name: 'Admin Sistema', company: null },
Â  Â  Â  { email: 'csirt@hub.it', password: 'csirt123', role: 'csirt', name: 'Marco Rossi', company: null },
Â  Â  Â  { email: 'azienda@test.it', password: 'azienda123', role: 'azienda', name: 'Giuseppe Verdi', company: 'Azienda Test SRL' }
Â  Â  ];

Â  Â  // === INITIALIZATION ===
Â  Â  document.addEventListener('DOMContentLoaded', function() {
Â  Â  Â  checkExistingSession();
Â  Â  });

Â  Â  // === LOGIN FUNCTIONS ===
Â  Â  function handleLogin(event) {
Â  Â  Â  event.preventDefault();
Â  Â  Â Â 
Â  Â  Â  const email = document.getElementById('login-email').value.trim();
Â  Â  Â  const password = document.getElementById('login-password').value.trim();
Â  Â  Â  const role = document.getElementById('login-role').value;
Â  Â  Â Â 
Â  Â  Â  const user = DEMO_USERS.find(u =>Â 
Â  Â  Â  Â  u.email === email &&Â 
Â  Â  Â  Â  u.password === password &&Â 
Â  Â  Â  Â  u.role === role
Â  Â  Â  );
Â  Â  Â Â 
Â  Â  Â  if (user) {
Â  Â  Â  Â  currentUser = {
Â  Â  Â  Â  Â  email: user.email,
Â  Â  Â  Â  Â  role: user.role,
Â  Â  Â  Â  Â  name: user.name,
Â  Â  Â  Â  Â  company: user.company
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  localStorage.setItem('currentUser', JSON.stringify(currentUser));
Â  Â  Â  Â  showMainApp();
Â  Â  Â  } else {
Â  Â  Â  Â  const existingError = document.querySelector('#login-error-message');
Â  Â  Â  Â  if (existingError) existingError.remove();
Â  Â  Â  Â Â 
Â  Â  Â  Â  const statusDiv = document.createElement('div');
Â  Â  Â  Â  statusDiv.id = 'login-error-message';
Â  Â  Â  Â  statusDiv.className = 'mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm';
Â  Â  Â  Â  statusDiv.innerHTML = `
Â  Â  Â  Â  Â  <div class="flex items-start space-x-2">
Â  Â  Â  Â  Â  Â  <svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
Â  Â  Â  Â  Â  Â  Â  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <strong class="font-semibold">âŒ Credenziali non valide</strong>
Â  Â  Â  Â  Â  Â  Â  <div class="mt-2 text-xs">
Â  Â  Â  Â  Â  Â  Â  Â  Verifica email, password e ruolo
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('login-form').appendChild(statusDiv);
Â  Â  Â  Â  setTimeout(() => statusDiv.remove(), 6000);
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function checkExistingSession() {
Â  Â  Â  const savedUser = localStorage.getItem('currentUser');
Â  Â  Â  if (savedUser) {
Â  Â  Â  Â  currentUser = JSON.parse(savedUser);
Â  Â  Â  Â  showMainApp();
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function showMainApp() {
Â  Â  Â  document.getElementById('login-screen').classList.add('hidden');
Â  Â  Â  document.getElementById('main-app').classList.remove('hidden');
Â  Â  Â Â 
Â  Â  Â  document.getElementById('user-name').textContent = currentUser.name;
Â  Â  Â Â 
Â  Â  Â  const roleLabels = {
Â  Â  Â  Â  'admin': 'Amministratore',
Â  Â  Â  Â  'csirt': 'Consulente CSIRT',
Â  Â  Â  Â  'azienda': 'Referente Aziendale'
Â  Â  Â  };
Â  Â  Â  document.getElementById('user-role').textContent = roleLabels[currentUser.role];
Â  Â  Â Â 
Â  Â  Â  filterSidebarByRole();
Â  Â  Â  loadDashboardData();
Â  Â  Â Â 
Â  Â  Â  if (currentUser.role === 'csirt') {
Â  Â  Â  Â  document.getElementById('csirt-dashboard-cards').classList.remove('hidden');
Â  Â  Â  Â  updateIncidentCount();
Â  Â  Â  Â  updateDesignationStatus();
Â  Â  Â  Â  updateNetworkStatus();
Â  Â  Â  } else {
        document.getElementById('csirt-dashboard-cards').classList.add('hidden');
      }
Â  Â  Â Â 
Â  Â  Â  // Load admin sections if admin
Â  Â  Â  if (currentUser.role === 'admin') {
Â  Â  Â  Â  renderCompaniesList();
Â  Â  Â  Â  renderUsersTable();
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function filterSidebarByRole() {
Â  Â  Â  const navItems = document.querySelectorAll('.nav-item[data-role]');
Â  Â  Â  navItems.forEach(item => {
Â  Â  Â  Â  const allowedRoles = item.getAttribute('data-role').split(',');
Â  Â  Â  Â  if (!allowedRoles.includes(currentUser.role)) {
Â  Â  Â  Â  Â  item.style.display = 'none';
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  item.style.display = 'flex';
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  }
Â  Â Â 
Â  Â  function logout() {
Â  Â  Â  localStorage.removeItem('currentUser');
Â  Â  Â  currentUser = null;
Â  Â  Â  document.getElementById('main-app').classList.add('hidden');
Â  Â  Â  document.getElementById('login-screen').classList.remove('hidden');
Â  Â  Â  document.getElementById('login-form').reset();
Â  Â  }
Â  Â Â 
Â  Â  // === NAVIGATION ===
Â  Â  function showSection(sectionName) {
Â  Â  Â  console.log('Navigating to section:', sectionName);
Â  Â  Â Â 
Â  Â  Â  document.querySelectorAll('.section-content').forEach(section => {
Â  Â  Â  Â  section.classList.add('hidden');
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  document.querySelectorAll('.nav-item').forEach(item => {
Â  Â  Â  Â  item.classList.remove('bg-blue-50', 'text-blue-600', 'font-medium');
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  const section = document.getElementById(sectionName + '-section');
Â  Â  Â  if (section) {
Â  Â  Â  Â  section.classList.remove('hidden');
Â  Â  Â  Â  console.log('Section found and displayed:', sectionName);
Â  Â  Â  } else {
Â  Â  Â  Â  console.error('Section not found:', sectionName + '-section');
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  // Usa la logica di fallback se non Ã¨ stata invocata da un pulsante sidebar
Â  Â  Â  const navItem = document.querySelector(`.nav-item[onclick*="'${sectionName}'"]`);
Â  Â  Â  if (navItem) {
Â  Â  Â  Â  navItem.classList.add('bg-blue-50', 'text-blue-600', 'font-medium');
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  // Load section-specific data
Â  Â  Â  console.log('Loading data for section:', sectionName);
Â  Â  Â  if (sectionName === 'companies') {
Â  Â  Â  Â  setTimeout(() => renderCompaniesList(), 100);
Â  Â  Â  } else if (sectionName === 'users') {
Â  Â  Â  Â  setTimeout(() => renderUsersTable(), 100);
Â  Â  Â  } else if (sectionName === 'incidents') {
Â  Â  Â  Â  // Quando si naviga alla sezione incidenti, assicurati che il tab "list" sia attivo di default
Â  Â  Â  Â  setTimeout(() => {
            switchIncidentTab('list');
            renderIncidentsList();
          }, 100);
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function loadDashboardData() {
Â  Â  Â  document.getElementById('total-companies').textContent = companies.length;
Â  Â  Â  document.getElementById('open-incidents').textContent = incidents.filter(i => i.status === 'aperto' || i.status === 'in-corso').length;
Â  Â  Â  document.getElementById('pending-notifications').textContent = '0'; // Placeholder
Â  Â  Â  document.getElementById('compliance-score').textContent = '85%'; // Placeholder
Â  Â  }
Â  Â Â 
Â  Â  // === UTILITY FUNCTIONS ===
Â  Â  function showSuccessMessage(message) {
Â  Â  Â  const toast = document.createElement('div');
Â  Â  Â  toast.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
Â  Â  Â  toast.textContent = message;
Â  Â  Â  document.body.appendChild(toast);
Â  Â  Â  setTimeout(() => toast.remove(), 3000);
Â  Â  }
Â  Â Â 
Â  Â  function showErrorMessage(message) {
Â  Â  Â  const toast = document.createElement('div');
Â  Â  Â  toast.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
Â  Â  Â  toast.textContent = message;
Â  Â  Â  document.body.appendChild(toast);
Â  Â  Â  setTimeout(() => toast.remove(), 3000);
Â  Â  }
Â  Â Â 
Â  Â  // === CSIRT DASHBOARD CARDS MANAGEMENT ===
Â  Â  // Funzione aggiornata per reindirizzare alla sezione principale Incidenti
Â  Â  function openIncidentsDetail() {
      // Nasconde le card della dashboard e naviga alla sezione Incidenti
      document.getElementById('csirt-dashboard-cards').classList.add('hidden');
      showSection('incidents');
      switchIncidentTab('list');
      renderIncidentsList();
      updateIncidentCount();
    }
Â  Â Â 
Â  Â  // Funzione aggiornata per reindirizzare alla sezione Designazione
Â  Â  function openDesignationDetail() {
      document.getElementById('csirt-dashboard-cards').classList.add('hidden');
      showSection('designation-detail');
      updateDesignationStatus();
    }
Â  Â Â 
Â  Â  // Funzione aggiornata per reindirizzare alla sezione Network
Â  Â  function openNetworkDetail() {
      document.getElementById('csirt-dashboard-cards').classList.add('hidden');
      showSection('network-detail');
      loadNetworkVisualization();
      updateNetworkStatus();
    }
Â  Â Â 
Â  Â  function updateIncidentCount() {
Â  Â  Â  const count = incidents.length;
Â  Â  Â  document.getElementById('incident-count').textContent = count;
Â  Â  }
Â  Â Â 
Â  Â  function updateDesignationStatus() {
Â  Â  Â  const statusElement = document.getElementById('designation-status');
Â  Â  Â  if (designationData) {
Â  Â  Â  Â  statusElement.textContent = 'âœ… Compilato';
Â  Â  Â  Â  statusElement.classList.remove('text-purple-600');
Â  Â  Â  Â  statusElement.classList.add('text-green-600');
Â  Â  Â  } else {
Â  Â  Â  Â  statusElement.textContent = 'Non compilato';
Â  Â  Â  Â  statusElement.classList.remove('text-green-600');
Â  Â  Â  Â  statusElement.classList.add('text-purple-600');
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function updateNetworkStatus() {
Â  Â  Â  const statusElement = document.getElementById('network-status');
Â  Â  Â  if (networkConfig) {
Â  Â  Â  Â  statusElement.textContent = 'âœ… Configurato';
Â  Â  Â  Â  statusElement.classList.remove('text-blue-600');
Â  Â  Â  Â  statusElement.classList.add('text-green-600');
Â  Â  Â  } else {
Â  Â  Â  Â  statusElement.textContent = 'Non configurato';
Â  Â  Â  Â  statusElement.classList.remove('text-green-600');
Â  Â  Â  Â  statusElement.classList.add('text-blue-600');
Â  Â  Â  }
Â  Â  }

    // Funzione unificata per i Tab della sezione Incidenti
Â  Â  function switchIncidentTab(tabName) {
      // Rimuovi la classe attiva da tutti i tab
Â  Â  Â  document.querySelectorAll('.incident-tab').forEach(tab => {
Â  Â  Â  Â  tab.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
Â  Â  Â  Â  tab.classList.add('text-gray-500', 'hover:text-gray-700');
Â  Â  Â  });
Â  Â  Â Â 
      // Nascondi tutti i contenuti dei tab
Â  Â  Â  document.querySelectorAll('.incident-tab-content').forEach(content => {
Â  Â  Â  Â  content.classList.add('hidden');
Â  Â  Â  });
Â  Â  Â Â 
      // Attiva il tab e il contenuto corretto
Â  Â  Â  document.getElementById('tab-' + tabName).classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
Â  Â  Â  document.getElementById('tab-' + tabName).classList.remove('text-gray-500', 'hover:text-gray-700');
Â  Â  Â  document.getElementById('incident-tab-' + tabName).classList.remove('hidden');
Â  Â  Â Â 
Â  Â  Â  if (tabName === 'list') {
Â  Â  Â  Â  renderIncidentsList();
Â  Â  Â  } else if (tabName === 'drafts') {
Â  Â  Â  Â  renderDraftsList();
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function switchNetworkTab(tabName) {
Â  Â  Â  document.querySelectorAll('.network-tab').forEach(tab => {
Â  Â  Â  Â  tab.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
Â  Â  Â  Â  tab.classList.add('text-gray-500');
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  document.querySelectorAll('.network-tab-content').forEach(content => {
Â  Â  Â  Â  content.classList.add('hidden');
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  document.getElementById('network-tab-' + tabName).classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
Â  Â  Â  document.getElementById('network-tab-' + tabName).classList.remove('text-gray-500');
Â  Â  Â  document.getElementById('network-subcontent-' + tabName).classList.remove('hidden');
Â  Â  Â Â 
Â  Â  Â  if (tabName === 'visualization') {
Â  Â  Â  Â  loadNetworkVisualization();
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  // === INCIDENTS MANAGEMENT ===
Â  Â  let incidents = JSON.parse(localStorage.getItem('incidents') || '[]');
Â  Â  let drafts = JSON.parse(localStorage.getItem('incident_drafts') || '[]');
Â  Â Â 
Â  Â  function toggleACNFields() {
Â  Â  Â  const checkbox = document.getElementById('incident-acn-required');
Â  Â  Â  const fields = document.getElementById('acn-fields');
Â  Â  Â  if (checkbox.checked) {
Â  Â  Â  Â  fields.classList.remove('hidden');
Â  Â  Â  } else {
Â  Â  Â  Â  fields.classList.add('hidden');
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function loadNetworkVisualization() {
Â  Â  Â  if (networkConfig) {
Â  Â  Â  Â  document.getElementById('stat-sites').textContent = networkConfig.topology?.sites || '-';
Â  Â  Â  Â  document.getElementById('stat-users').textContent = networkConfig.topology?.users || '-';
Â  Â  Â  Â Â 
Â  Â  Â  Â  const vlanCount = networkConfig.topology?.vlans ? networkConfig.topology.vlans.split(',').length : 0;
Â  Â  Â  Â  document.getElementById('stat-vlans').textContent = vlanCount || '-';
Â  Â  Â  Â Â 
Â  Â  Â  Â  let securityLevel = 'Base';
Â  Â  Â  Â  if (networkConfig.security?.firewallType && networkConfig.security?.antimalware !== 'none' && networkConfig.monitoring?.siem !== 'no') {
Â  Â  Â  Â  Â  securityLevel = 'Alto';
Â  Â  Â  Â  } else if (networkConfig.security?.firewallType) {
Â  Â  Â  Â  Â  securityLevel = 'Medio';
Â  Â  Â  Â  }
Â  Â  Â  Â  document.getElementById('stat-security').textContent = securityLevel;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (networkConfig.security?.firewallType) {
Â  Â  Â  Â  Â  const fwLabel = getLabelFromValue('firewall-type', networkConfig.security.firewallType);
Â  Â  Â  Â  Â  document.getElementById('firewall-label').textContent = fwLabel.substring(0, 15);
Â  Â  Â  Â  }
Â  Â  Â  } else {
Â  Â  Â  Â  document.getElementById('stat-sites').textContent = '-';
Â  Â  Â  Â  document.getElementById('stat-users').textContent = '-';
Â  Â  Â  Â  document.getElementById('stat-vlans').textContent = '-';
Â  Â  Â  Â  document.getElementById('stat-security').textContent = '-';
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function saveIncident(event) {
Â  Â  Â  event.preventDefault();
Â  Â  Â Â 
Â  Â  Â  const incident = {
Â  Â  Â  Â  id: 'INC-' + Date.now(),
Â  Â  Â  Â  title: document.getElementById('incident-title').value,
Â  Â  Â  Â  datetime: document.getElementById('incident-datetime').value,
Â  Â  Â  Â  severity: document.getElementById('incident-severity').value,
Â  Â  Â  Â  status: document.getElementById('incident-status').value,
Â  Â  Â  Â  description: document.getElementById('incident-description').value,
Â  Â  Â  Â  type: document.getElementById('incident-type').value,
Â  Â  Â  Â  asset: document.getElementById('incident-asset').value,
Â  Â  Â  Â  users: document.getElementById('incident-users').value,
Â  Â  Â  Â  duration: document.getElementById('incident-duration').value,
Â  Â  Â  Â  impact: document.getElementById('incident-impact').value,
Â  Â  Â  Â  dataLoss: document.getElementById('incident-data-loss').checked,
Â  Â  Â  Â  containment: document.getElementById('incident-containment').value,
Â  Â  Â  Â  corrective: document.getElementById('incident-corrective').value,
Â  Â  Â  Â  recommendations: document.getElementById('incident-recommendations').value,
Â  Â  Â  Â  acnRequired: document.getElementById('incident-acn-required').checked,
Â  Â  Â  Â  acnDateInitial: document.getElementById('incident-acn-date-initial').value,
Â  Â  Â  Â  acnDateIntermediate: document.getElementById('incident-acn-date-intermediate').value,
Â  Â  Â  Â  acnDateFinal: document.getElementById('incident-acn-date-final').value,
Â  Â  Â  Â  acnProtocol: document.getElementById('incident-acn-protocol').value,
Â  Â  Â  Â  acnNotes: document.getElementById('incident-acn-notes').value,
Â  Â  Â  Â  createdAt: new Date().toISOString(),
Â  Â  Â  Â  createdBy: currentUser.name
Â  Â  Â  };
Â  Â  Â Â 
Â  Â  Â  incidents.push(incident);
Â  Â  Â  localStorage.setItem('incidents', JSON.stringify(incidents));
Â  Â  Â Â 
Â  Â  Â  showSuccessMessage('âœ… Incidente salvato con successo!');
Â  Â  Â  resetIncidentForm();
Â  Â  Â  switchIncidentTab('list');
Â  Â  Â  updateIncidentCount();
Â  Â  }
Â  Â Â 
Â  Â  function resetIncidentForm() {
Â  Â  Â  document.getElementById('incident-form').reset();
Â  Â  Â  document.getElementById('acn-fields').classList.add('hidden');
Â  Â  }
Â  Â Â 
Â  Â  function renderIncidentsList() {
Â  Â  Â  const container = document.getElementById('incidents-list');
Â  Â  Â Â 
Â  Â  Â  if (incidents.length === 0) {
Â  Â  Â  Â  container.innerHTML = '<p class="text-center text-gray-500 py-8">Nessun incidente registrato</p>';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  container.innerHTML = incidents.map(inc => `
Â  Â  Â  Â  <div class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
Â  Â  Â  Â  Â  <div class="flex items-start justify-between">
Â  Â  Â  Â  Â  Â  <div class="flex-1">
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center space-x-3 mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800">${inc.title}</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="status-badge status-${inc.status}">${inc.status}</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="status-badge severity-${inc.severity}">${getSeverityLabel(inc.severity)}</span>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-600 mb-2">${inc.description}</p>
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center space-x-4 text-sm text-gray-500">
Â  Â  Â  Â  Â  Â  Â  Â  <span>ğŸ†” ${inc.id}</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span>ğŸ“… ${new Date(inc.datetime).toLocaleString('it-IT')}</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span>ğŸ‘¤ ${inc.createdBy}</span>
Â  Â  Â  Â  Â  Â  Â  Â  ${inc.acnRequired ? '<span class="text-red-600 font-medium">ğŸ“¢ ACN Required</span>' : ''}
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="flex space-x-2">
Â  Â  Â  Â  Â  Â  Â  <button onclick="viewIncidentDetails('${inc.id}')" class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded">
Â  Â  Â  Â  Â  Â  Â  Â  Dettagli
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  <button onclick="deleteIncident('${inc.id}')" class="px-3 py-1 bg-red-500 hover:bg-red-600 text-white text-sm rounded">
Â  Â  Â  Â  Â  Â  Â  Â  Elimina
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `).join('');
Â  Â  }
Â  Â Â 
Â  Â  function getSeverityLabel(severity) {
Â  Â  Â  const labels = {
Â  Â  Â  Â  'critical': 'ğŸ”´ Critica',
Â  Â  Â  Â  'high': 'ğŸŸ  Alta',
Â  Â  Â  Â  'medium': 'ğŸŸ¡ Media',
Â  Â  Â  Â  'low': 'ğŸ”µ Bassa'
Â  Â  Â  };
Â  Â  Â  return labels[severity] || severity;
Â  Â  }
Â  Â Â 
Â  Â  function viewIncidentDetails(incidentId) {
Â  Â  Â  const incident = incidents.find(i => i.id === incidentId);
Â  Â  Â  if (!incident) return;
Â  Â  Â Â 
Â  Â  Â  const modal = document.createElement('div');
Â  Â  Â  modal.className = 'fixed inset-0 modal-overlay flex items-center justify-center z-50';
Â  Â  Â  modal.innerHTML = `
Â  Â  Â  Â  <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
Â  Â  Â  Â  Â  <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-t-xl">
Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-start">
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-bold mb-2">${incident.title}</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex space-x-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="status-badge status-${incident.status}">${incident.status}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="status-badge severity-${incident.severity}">${getSeverityLabel(incident.severity)}</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <button onclick="this.closest('.modal-overlay').remove()" class="text-white hover:text-gray-200">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <div class="p-6 space-y-6">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800 mb-2">ğŸ“‹ Informazioni Generali</h3>
Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-4 text-sm">
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">ID:</span> ${incident.id}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Data/Ora:</span> ${new Date(incident.datetime).toLocaleString('it-IT')}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Tipo:</span> ${incident.type}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Asset:</span> ${incident.asset || 'N/A'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Creato da:</span> ${incident.createdBy}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Creato il:</span> ${new Date(incident.createdAt).toLocaleString('it-IT')}</div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800 mb-2">ğŸ“ Descrizione</h3>
Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-700">${incident.description}</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800 mb-2">ğŸ’¥ Impatto</h3>
Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-4 text-sm">
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Utenti coinvolti:</span> ${incident.users || 'N/A'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Durata interruzione:</span> ${incident.duration || 'N/A'} ore</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="col-span-2"><span class="font-medium">Perdita dati:</span> ${incident.dataLoss ? 'âœ… SÃ¬' : 'âŒ No'}</div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  ${incident.impact ? `<p class="mt-2 text-gray-700">${incident.impact}</p>` : ''}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800 mb-2">ğŸ› ï¸ Azioni</h3>
Â  Â  Â  Â  Â  Â  Â  ${incident.containment ? `<div class="mb-3"><span class="font-medium">Contenimento:</span><p class="text-gray-700">${incident.containment}</p></div>` : ''}
Â  Â  Â  Â  Â  Â  Â  ${incident.corrective ? `<div class="mb-3"><span class="font-medium">Azioni correttive:</span><p class="text-gray-700">${incident.corrective}</p></div>` : ''}
Â  Â  Â  Â  Â  Â  Â  ${incident.recommendations ? `<div><span class="font-medium">Raccomandazioni:</span><p class="text-gray-700">${incident.recommendations}</p></div>` : ''}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ${incident.acnRequired ? `
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800 mb-2">ğŸ“¢ Notifica ACN</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-4 text-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Notifica iniziale:</span> ${incident.acnDateInitial ? new Date(incident.acnDateInitial).toLocaleString('it-IT') : 'N/A'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Notifica intermedia:</span> ${incident.acnDateIntermediate ? new Date(incident.acnDateIntermediate).toLocaleString('it-IT') : 'N/A'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Notifica finale:</span> ${incident.acnDateFinal ? new Date(incident.acnDateFinal).toLocaleString('it-IT') : 'N/A'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Protocollo:</span> ${incident.acnProtocol || 'N/A'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  ${incident.acnNotes ? `<p class="mt-2 text-gray-700">${incident.acnNotes}</p>` : ''}
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  ` : ''}
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <div class="bg-gray-50 p-6 rounded-b-xl flex justify-end space-x-4">
Â  Â  Â  Â  Â  Â  <button onclick="exportSingleIncident('${incident.id}')" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg">
Â  Â  Â  Â  Â  Â  Â  Esporta PDF
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button onclick="this.closest('.modal-overlay').remove()" class="px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg">
Â  Â  Â  Â  Â  Â  Â  Chiudi
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  Â  document.body.appendChild(modal);
Â  Â  }
Â  Â Â 
Â  Â  function deleteIncident(incidentId) {
Â  Â  Â  if (confirm('Sei sicuro di voler eliminare questo incidente?')) {
Â  Â  Â  Â  incidents = incidents.filter(i => i.id !== incidentId);
Â  Â  Â  Â  localStorage.setItem('incidents', JSON.stringify(incidents));
Â  Â  Â  Â  renderIncidentsList();
Â  Â  Â  Â  updateIncidentCount();
Â  Â  Â  Â  showSuccessMessage('âœ… Incidente eliminato');
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function saveDraft() {
Â  Â  Â  const draft = {
Â  Â  Â  Â  id: 'DRAFT-' + Date.now(),
Â  Â  Â  Â  title: document.getElementById('incident-title').value,
Â  Â  Â  Â  datetime: document.getElementById('incident-datetime').value,
Â  Â  Â  Â  severity: document.getElementById('incident-severity').value,
Â  Â  Â  Â  status: document.getElementById('incident-status').value,
Â  Â  Â  Â  description: document.getElementById('incident-description').value,
Â  Â  Â  Â  type: document.getElementById('incident-type').value,
Â  Â  Â  Â  asset: document.getElementById('incident-asset').value,
Â  Â  Â  Â  users: document.getElementById('incident-users').value,
Â  Â  Â  Â  duration: document.getElementById('incident-duration').value,
Â  Â  Â  Â  impact: document.getElementById('incident-impact').value,
Â  Â  Â  Â  dataLoss: document.getElementById('incident-data-loss').checked,
Â  Â  Â  Â  containment: document.getElementById('incident-containment').value,
Â  Â  Â  Â  corrective: document.getElementById('incident-corrective').value,
Â  Â  Â  Â  recommendations: document.getElementById('incident-recommendations').value,
Â  Â  Â  Â  acnRequired: document.getElementById('incident-acn-required').checked,
Â  Â  Â  Â  acnDateInitial: document.getElementById('incident-acn-date-initial').value,
Â  Â  Â  Â  acnDateIntermediate: document.getElementById('incident-acn-date-intermediate').value,
Â  Â  Â  Â  acnDateFinal: document.getElementById('incident-acn-date-final').value,
Â  Â  Â  Â  acnProtocol: document.getElementById('incident-acn-protocol').value,
Â  Â  Â  Â  acnNotes: document.getElementById('incident-acn-notes').value,
Â  Â  Â  Â  savedAt: new Date().toISOString()
Â  Â  Â  };
Â  Â  Â Â 
Â  Â  Â  drafts.push(draft);
Â  Â  Â  localStorage.setItem('incident_drafts', JSON.stringify(drafts));
Â  Â  Â  showSuccessMessage('ğŸ’¾ Bozza salvata!');
Â  Â  Â  resetIncidentForm();
Â  Â  Â  switchIncidentTab('drafts');
Â  Â  }
Â  Â Â 
Â  Â  function renderDraftsList() {
Â  Â  Â  const container = document.getElementById('drafts-list');
Â  Â  Â Â 
Â  Â  Â  if (drafts.length === 0) {
Â  Â  Â  Â  container.innerHTML = '<p class="text-center text-gray-500 py-8">Nessuna bozza salvata</p>';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  container.innerHTML = drafts.map(draft => `
Â  Â  Â  Â  <div class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
Â  Â  Â  Â  Â  <div class="flex items-start justify-between">
Â  Â  Â  Â  Â  Â  <div class="flex-1">
Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold text-gray-800 mb-2">${draft.title || 'Bozza senza titolo'}</h3>
Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-600 mb-2">${draft.description || 'Nessuna descrizione'}</p>
Â  Â  Â  Â  Â  Â  Â  <div class="text-sm text-gray-500">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ’¾ Salvata il: ${new Date(draft.savedAt).toLocaleString('it-IT')}
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="flex space-x-2">
Â  Â  Â  Â  Â  Â  Â  <button onclick="loadDraft('${draft.id}')" class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded">
Â  Â  Â  Â  Â  Â  Â  Â  Carica
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  <button onclick="deleteDraft('${draft.id}')" class="px-3 py-1 bg-red-500 hover:bg-red-600 text-white text-sm rounded">
Â  Â  Â  Â  Â  Â  Â  Â  Elimina
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `).join('');
Â  Â  }
Â  Â Â 
Â  Â  function loadDraft(draftId) {
Â  Â  Â  const draft = drafts.find(d => d.id === draftId);
Â  Â  Â  if (!draft) return;
Â  Â  Â Â 
Â  Â  Â  document.getElementById('incident-title').value = draft.title || '';
Â  Â  Â  document.getElementById('incident-datetime').value = draft.datetime || '';
Â  Â  Â  document.getElementById('incident-severity').value = draft.severity || '';
Â  Â  Â  document.getElementById('incident-status').value = draft.status || '';
Â  Â  Â  document.getElementById('incident-description').value = draft.description || '';
Â  Â  Â  document.getElementById('incident-type').value = draft.type || '';
Â  Â  Â  document.getElementById('incident-asset').value = draft.asset || '';
Â  Â  Â  document.getElementById('incident-users').value = draft.users || '';
Â  Â  Â  document.getElementById('incident-duration').value = draft.duration || '';
Â  Â  Â  document.getElementById('incident-impact').value = draft.impact || '';
Â  Â  Â  document.getElementById('incident-data-loss').checked = draft.dataLoss || false;
Â  Â  Â  document.getElementById('incident-containment').value = draft.containment || '';
Â  Â  Â  document.getElementById('incident-corrective').value = draft.corrective || '';
Â  Â  Â  document.getElementById('incident-recommendations').value = draft.recommendations || '';
Â  Â  Â  document.getElementById('incident-acn-required').checked = draft.acnRequired || false;
Â  Â  Â  document.getElementById('incident-acn-date-initial').value = draft.acnDateInitial || '';
Â  Â  Â  document.getElementById('incident-acn-date-intermediate').value = draft.acnDateIntermediate || '';
Â  Â  Â  document.getElementById('incident-acn-date-final').value = draft.acnDateFinal || '';
Â  Â  Â  document.getElementById('incident-acn-protocol').value = draft.acnProtocol || '';
Â  Â  Â  document.getElementById('incident-acn-notes').value = draft.acnNotes || '';
Â  Â  Â Â 
Â  Â  Â  if (draft.acnRequired) {
Â  Â  Â  Â  document.getElementById('acn-fields').classList.remove('hidden');
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  switchIncidentTab('new');
Â  Â  Â  showSuccessMessage('ğŸ“ Bozza caricata nel form');
Â  Â  }
Â  Â Â 
Â  Â  function deleteDraft(draftId) {
Â  Â  Â  if (confirm('Eliminare questa bozza?')) {
Â  Â  Â  Â  drafts = drafts.filter(d => d.id !== draftId);
Â  Â  Â  Â  localStorage.setItem('incident_drafts', JSON.stringify(drafts));
Â  Â  Â  Â  renderDraftsList();
Â  Â  Â  Â  showSuccessMessage('âœ… Bozza eliminata');
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function exportIncidents() {
Â  Â  Â  if (incidents.length === 0) {
Â  Â  Â  Â  showErrorMessage('Nessun incidente da esportare');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  const wb = XLSX.utils.book_new();
Â  Â  Â  const data = incidents.map(inc => ({
Â  Â  Â  Â  'ID': inc.id,
Â  Â  Â  Â  'Titolo': inc.title,
Â  Â  Â  Â  'Data/Ora': new Date(inc.datetime).toLocaleString('it-IT'),
Â  Â  Â  Â  'GravitÃ ': getSeverityLabel(inc.severity),
Â  Â  Â  Â  'Stato': inc.status,
Â  Â  Â  Â  'Tipo': inc.type,
Â  Â  Â  Â  'Descrizione': inc.description,
Â  Â  Â  Â  'Asset Colpito': inc.asset || '',
Â  Â  Â  Â  'Utenti Coinvolti': inc.users || '',
Â  Â  Â  Â  'Durata (ore)': inc.duration || '',
Â  Â  Â  Â  'Notifica ACN': inc.acnRequired ? 'SÃ¬' : 'No',
Â  Â  Â  Â  'Creato da': inc.createdBy,
Â  Â  Â  Â  'Creato il': new Date(inc.createdAt).toLocaleString('it-IT')
Â  Â  Â  }));
Â  Â  Â Â 
Â  Â  Â  const ws = XLSX.utils.json_to_sheet(data);
Â  Â  Â  XLSX.utils.book_append_sheet(wb, ws, 'Incidenti');
Â  Â  Â  XLSX.writeFile(wb, `Registro_Incidenti_${new Date().toISOString().split('T')[0]}.xlsx`);
Â  Â  Â  showSuccessMessage('âœ… Export Excel completato!');
Â  Â  }
Â  Â Â 
Â  Â  function exportSingleIncident(incidentId) {
Â  Â  Â  const incident = incidents.find(i => i.id === incidentId);
Â  Â  Â  if (!incident) return;
Â  Â  Â Â 
Â  Â  Â  const { jsPDF } = window.jspdf;
Â  Â  Â  const doc = new jsPDF();
Â  Â  Â Â 
Â  Â  Â  doc.setFontSize(18);
Â  Â  Â  doc.text('REGISTRO INCIDENTE DI SICUREZZA', 105, 20, { align: 'center' });
Â  Â  Â Â 
Â  Â  Â  doc.setFontSize(12);
Â  Â  Â  let y = 40;
Â  Â  Â Â 
Â  Â  Â  doc.text(`ID: ${incident.id}`, 20, y);
Â  Â  Â  y += 10;
Â  Â  Â  doc.text(`Titolo: ${incident.title}`, 20, y);
Â  Â  Â  y += 10;
Â  Â  Â  doc.text(`Data/Ora: ${new Date(incident.datetime).toLocaleString('it-IT')}`, 20, y);
Â  Â  Â  y += 10;
Â  Â  Â  doc.text(`GravitÃ : ${getSeverityLabel(incident.severity)}`, 20, y);
Â  Â  Â  y += 10;
Â  Â  Â  doc.text(`Stato: ${incident.status}`, 20, y);
Â  Â  Â  y += 15;
Â  Â  Â Â 
Â  Â  Â  doc.text('Descrizione:', 20, y);
Â  Â  Â  y += 7;
Â  Â  Â  const descLines = doc.splitTextToSize(incident.description, 170);
Â  Â  Â  doc.text(descLines, 20, y);
Â  Â  Â Â 
Â  Â  Â  doc.save(`Incidente_${incident.id}.pdf`);
Â  Â  Â  showSuccessMessage('âœ… PDF generato!');
Â  Â  }
Â  Â Â 
Â  Â  // === NETWORK CONFIGURATION ===
Â  Â  let networkConfig = JSON.parse(localStorage.getItem('network_config') || 'null');
Â  Â  let currentNetworkStep = 1;
Â  Â  const totalNetworkSteps = 5;
Â  Â Â 
Â  Â  function nextNetworkStep() {
Â  Â  Â  if (currentNetworkStep < totalNetworkSteps) {
Â  Â  Â  Â  document.getElementById(`network-step-${currentNetworkStep}`).classList.add('hidden');
Â  Â  Â  Â  currentNetworkStep++;
Â  Â  Â  Â  document.getElementById(`network-step-${currentNetworkStep}`).classList.remove('hidden');
Â  Â  Â  Â  updateNetworkStepIndicators();
Â  Â  Â  Â  updateNetworkButtons();
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (currentNetworkStep === totalNetworkSteps) {
Â  Â  Â  Â  Â  generateNetworkSummary();
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function previousNetworkStep() {
Â  Â  Â  if (currentNetworkStep > 1) {
Â  Â  Â  Â  document.getElementById(`network-step-${currentNetworkStep}`).classList.add('hidden');
Â  Â  Â  Â  currentNetworkStep--;
Â  Â  Â  Â  document.getElementById(`network-step-${currentNetworkStep}`).classList.remove('hidden');
Â  Â  Â  Â  updateNetworkStepIndicators();
Â  Â  Â  Â  updateNetworkButtons();
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function updateNetworkStepIndicators() {
Â  Â  Â  for (let i = 1; i <= totalNetworkSteps; i++) {
Â  Â  Â  Â  const indicator = document.getElementById(`step-indicator-${i}`);
Â  Â  Â  Â  if (i <= currentNetworkStep) {
Â  Â  Â  Â  Â  indicator.classList.add('bg-blue-600', 'text-white');
Â  Â  Â  Â  Â  indicator.classList.remove('bg-gray-300', 'text-gray-600');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  indicator.classList.remove('bg-blue-600', 'text-white');
Â  Â  Â  Â  Â  indicator.classList.add('bg-gray-300', 'text-gray-600');
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function updateNetworkButtons() {
Â  Â  Â  const prevBtn = document.getElementById('network-prev-btn');
Â  Â  Â  const nextBtn = document.getElementById('network-next-btn');
Â  Â  Â  const submitBtn = document.getElementById('network-submit-btn');
Â  Â  Â Â 
Â  Â  Â  if (currentNetworkStep === 1) {
Â  Â  Â  Â  prevBtn.classList.add('hidden');
Â  Â  Â  } else {
Â  Â  Â  Â  prevBtn.classList.remove('hidden');
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  if (currentNetworkStep === totalNetworkSteps) {
Â  Â  Â  Â  nextBtn.classList.add('hidden');
Â  Â  Â  Â  submitBtn.classList.remove('hidden');
Â  Â  Â  } else {
Â  Â  Â  Â  nextBtn.classList.remove('hidden');
Â  Â  Â  Â  submitBtn.classList.add('hidden');
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function generateNetworkSummary() {
Â  Â  Â  const summary = document.getElementById('network-summary');
Â  Â  Â Â 
Â  Â  Â  const data = {
Â  Â  Â  Â  topology: {
Â  Â  Â  Â  Â  type: document.getElementById('net-topology-type').value,
Â  Â  Â  Â  Â  sites: document.getElementById('net-sites-count').value,
Â  Â  Â  Â  Â  users: document.getElementById('net-users-count').value,
Â  Â  Â  Â  Â  segmentation: document.getElementById('net-segmentation').value,
Â  Â  Â  Â  Â  vlans: document.getElementById('net-vlans').value,
Â  Â  Â  Â  Â  ipAddressing: document.querySelector('input[name="ip-addressing"]:checked')?.value,
Â  Â  Â  Â  Â  ipRanges: document.getElementById('net-ip-ranges').value
Â  Â  Â  Â  },
Â  Â  Â  Â  security: {
Â  Â  Â  Â  Â  firewallType: document.getElementById('net-firewall-type').value,
Â  Â  Â  Â  Â  firewallModel: document.getElementById('net-firewall-model').value,
Â  Â  Â  Â  Â  fwStateful: document.getElementById('fw-stateful').checked,
Â  Â  Â  Â  Â  fwIps: document.getElementById('fw-ips').checked,
Â  Â  Â  Â  Â  fwAv: document.getElementById('fw-av').checked,
Â  Â  Â  Â  Â  fwWebFilter: document.getElementById('fw-web-filter').checked,
Â  Â  Â  Â  Â  fwAppControl: document.getElementById('fw-app-control').checked,
Â  Â  Â  Â  Â  fwSslInspect: document.getElementById('fw-ssl-inspect').checked,
Â  Â  Â  Â  Â  waf: document.getElementById('net-waf').value,
Â  Â  Â  Â  Â  antimalware: document.getElementById('net-antimalware').value,
Â  Â  Â  Â  Â  antimalwareProduct: document.getElementById('net-antimalware-product').value,
Â  Â  Â  Â  Â  emailSecurity: document.getElementById('net-email-security').value
Â  Â  Â  Â  },
Â  Â  Â  Â  connectivity: {
Â  Â  Â  Â  Â  internetType: document.getElementById('net-internet-type').value,
Â  Â  Â  Â  Â  isp: document.getElementById('net-isp').value,
Â  Â  Â  Â  Â  bandwidthDown: document.getElementById('net-bandwidth-down').value,
Â  Â  Â  Â  Â  bandwidthUp: document.getElementById('net-bandwidth-up').value,
Â  Â  Â  Â  Â  vpnType: document.getElementById('net-vpn-type').value,
Â  Â  Â  Â  Â  vpnSolution: document.getElementById('net-vpn-solution').value,
Â  Â  Â  Â  Â  mfa: document.getElementById('net-mfa').value,
Â  Â  Â  Â  Â  mfaSolution: document.getElementById('net-mfa-solution').value,
Â  Â  Â  Â  Â  wifi: document.getElementById('net-wifi').value,
Â  Â  Â  Â  Â  wifiAuth: document.getElementById('net-wifi-auth').value
Â  Â  Â  Â  },
Â  Â  Â  Â  monitoring: {
Â  Â  Â  Â  Â  siem: document.getElementById('net-siem').value,
Â  Â  Â  Â  Â  siemProduct: document.getElementById('net-siem-product').value,
Â  Â  Â  Â  Â  logRetention: document.getElementById('net-log-retention').value,
Â  Â  Â  Â  Â  logFirewall: document.getElementById('log-firewall').checked,
Â  Â  Â  Â  Â  logAuth: document.getElementById('log-authentication').checked,
Â  Â  Â  Â  Â  logVpn: document.getElementById('log-vpn').checked,
Â  Â  Â  Â  Â  logEmail: document.getElementById('log-email').checked,
Â  Â  Â  Â  Â  logWeb: document.getElementById('log-web').checked,
Â  Â  Â  Â  Â  logDns: document.getElementById('log-dns').checked,
Â  Â  Â  Â  Â  logDhcp: document.getElementById('log-dhcp').checked,
Â  Â  Â  Â  Â  logEndpoints: document.getElementById('log-endpoints').checked,
Â  Â  Â  Â  Â  monitoring: document.getElementById('net-monitoring').value,
Â  Â  Â  Â  Â  monitoringTool: document.getElementById('net-monitoring-tool').value,
Â  Â  Â  Â  Â  vulnScan: document.getElementById('net-vulnerability-scan').value,
Â  Â  Â  Â  Â  vulnTool: document.getElementById('net-vuln-tool').value
Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  Â Â 
Â  Â  Â  const firewallFeatures = [];
Â  Â  Â  if (data.security.fwStateful) firewallFeatures.push('Stateful Inspection');
Â  Â  Â  if (data.security.fwIps) firewallFeatures.push('IPS/IDS');
Â  Â  Â  if (data.security.fwAv) firewallFeatures.push('Antivirus Gateway');
Â  Â  Â  if (data.security.fwWebFilter) firewallFeatures.push('Web Filtering');
Â  Â  Â  if (data.security.fwAppControl) firewallFeatures.push('Application Control');
Â  Â  Â  if (data.security.fwSslInspect) firewallFeatures.push('SSL/TLS Inspection');
Â  Â  Â Â 
Â  Â  Â  const logTypes = [];
Â  Â  Â  if (data.monitoring.logFirewall) logTypes.push('Firewall');
Â  Â  Â  if (data.monitoring.logAuth) logTypes.push('Autenticazione');
Â  Â  Â  if (data.monitoring.logVpn) logTypes.push('VPN');
Â  Â  Â  if (data.monitoring.logEmail) logTypes.push('Email');
Â  Â  Â  if (data.monitoring.logWeb) logTypes.push('Web Proxy');
Â  Â  Â  if (data.monitoring.logDns) logTypes.push('DNS');
Â  Â  Â  if (data.monitoring.logDhcp) logTypes.push('DHCP');
Â  Â  Â  if (data.monitoring.logEndpoints) logTypes.push('Endpoints');
Â  Â  Â Â 
Â  Â  Â  summary.innerHTML = `
Â  Â  Â  Â  <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded">
Â  Â  Â  Â  Â  <h4 class="text-lg font-bold text-gray-800 mb-4">ğŸ”· Topologia Rete</h4>
Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-3 text-sm">
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Tipologia:</span> ${getLabelFromValue('topology-type', data.topology.type)}</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Numero Sedi:</span> ${data.topology.sites}</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Utenti:</span> ${data.topology.users}</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Segmentazione:</span> ${getLabelFromValue('segmentation', data.topology.segmentation)}</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Indirizzamento IP:</span> ${data.topology.ipAddressing?.toUpperCase() || 'N/A'}</div>
Â  Â  Â  Â  Â  Â  ${data.topology.ipRanges ? `<div class="col-span-2"><span class="font-medium">Range IP:</span> ${data.topology.ipRanges}</div>` : ''}
Â  Â  Â  Â  Â  Â  ${data.topology.vlans ? `<div class="col-span-2"><span class="font-medium">VLAN:</span> ${data.topology.vlans}</div>` : ''}
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="bg-green-50 border-l-4 border-green-500 p-6 rounded">
Â  Â  Â  Â  Â  <h4 class="text-lg font-bold text-gray-800 mb-4">ğŸ›¡ï¸ Sicurezza Perimetrale</h4>
Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-3 text-sm">
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Firewall:</span> ${getLabelFromValue('firewall-type', data.security.firewallType)}</div>
Â  Â  Â  Â  Â  Â  ${data.security.firewallModel ? `<div><span class="font-medium">Modello:</span> ${data.security.firewallModel}</div>` : '<div></div>'}
Â  Â  Â  Â  Â  Â  <div class="col-span-2"><span class="font-medium">FunzionalitÃ  FW:</span> ${firewallFeatures.length > 0 ? firewallFeatures.join(', ') : 'Nessuna'}</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">WAF:</span> ${getLabelFromValue('waf', data.security.waf)}</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Antimalware/EDR:</span> ${getLabelFromValue('antimalware', data.security.antimalware)}</div>
Â  Â  Â  Â  Â  Â  ${data.security.antimalwareProduct ? `<div class="col-span-2"><span class="font-medium">Soluzione:</span> ${data.security.antimalwareProduct}</div>` : ''}
Â  Â  Â  Â  Â  Â  <div class="col-span-2"><span class="font-medium">Email Security:</span> ${getLabelFromValue('email-security', data.security.emailSecurity)}</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="bg-purple-50 border-l-4 border-purple-500 p-6 rounded">
Â  Â  Â  Â  Â  <h4 class="text-lg font-bold text-gray-800 mb-4">ğŸ”Œ ConnettivitÃ  e Accessi</h4>
Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-3 text-sm">
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Connessione Internet:</span> ${getLabelFromValue('internet-type', data.connectivity.internetType)}</div>
Â  Â  Â  Â  Â  Â  ${data.connectivity.isp ? `<div><span class="font-medium">ISP:</span> ${data.connectivity.isp}</div>` : '<div></div>'}
Â  Â  Â  Â  Â  Â  ${data.connectivity.bandwidthDown ? `<div><span class="font-medium">Banda Download:</span> ${data.connectivity.bandwidthDown} Mbps</div>` : ''}
Â  Â  Â  Â  Â  Â  ${data.connectivity.bandwidthUp ? `<div><span class="font-medium">Banda Upload:</span> ${data.connectivity.bandwidthUp} Mbps</div>` : ''}
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">VPN:</span> ${getLabelFromValue('vpn-type', data.connectivity.vpnType)}</div>
Â  Â  Â  Â  Â  Â  ${data.connectivity.vpnSolution ? `<div><span class="font-medium">Soluzione VPN:</span> ${data.connectivity.vpnSolution}</div>` : '<div></div>'}
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">MFA:</span> ${getLabelFromValue('mfa', data.connectivity.mfa)}</div>
Â  Â  Â  Â  Â  Â  ${data.connectivity.mfaSolution ? `<div><span class="font-medium">Soluzione MFA:</span> ${data.connectivity.mfaSolution}</div>` : '<div></div>'}
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Wi-Fi:</span> ${getLabelFromValue('wifi', data.connectivity.wifi)}</div>
Â  Â  Â  Â  Â  Â  ${data.connectivity.wifiAuth ? `<div><span class="font-medium">Auth Wi-Fi:</span> ${getLabelFromValue('wifi-auth', data.connectivity.wifiAuth)}</div>` : '<div></div>'}
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="bg-yellow-50 border-l-4 border-yellow-500 p-6 rounded">
Â  Â  Â  Â  Â  <h4 class="text-lg font-bold text-gray-800 mb-4">ğŸ“Š Monitoraggio e Logging</h4>
Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-3 text-sm">
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">SIEM:</span> ${getLabelFromValue('siem', data.monitoring.siem)}</div>
Â  Â  Â  Â  Â  Â  ${data.monitoring.siemProduct ? `<div><span class="font-medium">Soluzione:</span> ${data.monitoring.siemProduct}</div>` : '<div></div>'}
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Retention Log:</span> ${data.monitoring.logRetention} giorni</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Monitoraggio:</span> ${getLabelFromValue('monitoring', data.monitoring.monitoring)}</div>
Â  Â  Â  Â  Â  Â  ${data.monitoring.monitoringTool ? `<div class="col-span-2"><span class="font-medium">Tool Monitoring:</span> ${data.monitoring.monitoringTool}</div>` : ''}
Â  Â  Â  Â  Â  Â  <div class="col-span-2"><span class="font-medium">Log Raccolti:</span> ${logTypes.length > 0 ? logTypes.join(', ') : 'Nessuno'}</div>
Â  Â  Â  Â  Â  Â  <div><span class="font-medium">Vulnerability Scan:</span> ${getLabelFromValue('vuln-scan', data.monitoring.vulnScan)}</div>
Â  Â  Â  Â  Â  Â  ${data.monitoring.vulnTool ? `<div><span class="font-medium">Tool Scanning:</span> ${data.monitoring.vulnTool}</div>` : '<div></div>'}
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  }
Â  Â Â 
Â  Â  function getLabelFromValue(fieldType, value) {
Â  Â  Â  const labels = {
Â  Â  Â  Â  'topology-type': {
Â  Â  Â  Â  Â  'lan': 'LAN',
Â  Â  Â  Â  Â  'wan': 'WAN',
Â  Â  Â  Â  Â  'hybrid': 'Ibrida (LAN + WAN)',
Â  Â  Â  Â  Â  'cloud': 'Cloud-Based',
Â  Â  Â  Â  Â  'sdwan': 'SD-WAN'
Â  Â  Â  Â  },
Â  Â  Â  Â  'segmentation': {
Â  Â  Â  Â  Â  'none': 'Nessuna segmentazione',
Â  Â  Â  Â  Â  'basic': 'Base (VLAN)',
Â  Â  Â  Â  Â  'advanced': 'Avanzata (DMZ)',
Â  Â  Â  Â  Â  'zero-trust': 'Zero Trust'
Â  Â  Â  Â  },
Â  Â  Â  Â  'firewall-type': {
Â  Â  Â  Â  Â  'hardware': 'Hardware Dedicato',
Â  Â  Â  Â  Â  'software': 'Software/Virtual',
Â  Â  Â  Â  Â  'ngfw': 'NGFW',
Â  Â  Â  Â  Â  'cloud': 'Cloud-based',
Â  Â  Â  Â  Â  'none': 'Nessuno'
Â  Â  Â  Â  },
Â  Â  Â  Â  'waf': {
Â  Â  Â  Â  Â  'yes-dedicated': 'SÃ¬ - WAF Dedicato',
Â  Â  Â  Â  Â  'yes-integrated': 'SÃ¬ - Integrato',
Â  Â  Â  Â  Â  'yes-cloud': 'SÃ¬ - Cloud WAF',
Â  Â  Â  Â  Â  'no': 'Non implementato'
Â  Â  Â  Â  },
Â  Â  Â  Â  'antimalware': {
Â  Â  Â  Â  Â  'edr': 'EDR',
Â  Â  Â  Â  Â  'traditional': 'Antivirus Tradizionale',
Â  Â  Â  Â  Â  'xdr': 'XDR',
Â  Â  Â  Â  Â  'none': 'Nessuno'
Â  Â  Â  Â  },
Â  Â  Â  Â  'email-security': {
Â  Â  Â  Â  Â  'yes-dedicated': 'Gateway Dedicato',
Â  Â  Â  Â  Â  'yes-cloud': 'Cloud-based',
Â  Â  Â  Â  Â  'basic': 'Protezione base',
Â  Â  Â  Â  Â  'no': 'Nessuna'
Â  Â  Â  Â  },
Â  Â  Â  Â  'internet-type': {
Â  Â  Â  Â  Â  'fiber': 'Fibra Ottica',
Â  Â  Â  Â  Â  'adsl': 'ADSL/VDSL',
Â  Â  Â  Â  Â  'leased-line': 'Linea Dedicata',
Â  Â  Â  Â  Â  '4g-5g': '4G/5G',
Â  Â  Â  Â  Â  'satellite': 'Satellite',
Â  Â  Â  Â  Â  'redundant': 'Ridondante'
Â  Â  Â  Â  },
Â  Â  Â  Â  'vpn-type': {
Â  Â  Â  Â  Â  'site-to-site': 'Site-to-Site VPN',
Â  Â  Â  Â  Â  'remote-access': 'Remote Access VPN',
Â  Â  Â  Â  Â  'both': 'Site-to-Site + Remote Access',
Â  Â  Â  Â  Â  'ssl-vpn': 'SSL VPN',
Â  Â  Â  Â  Â  'ipsec': 'IPsec VPN',
Â  Â  Â  Â  Â  'none': 'Nessuna VPN'
Â  Â  Â  Â  },
Â  Â  Â  Â  'mfa': {
Â  Â  Â  Â  Â  'yes-all': 'Tutti gli accessi',
Â  Â  Â  Â  Â  'yes-critical': 'Sistemi critici',
Â  Â  Â  Â  Â  'yes-admin': 'Account amministrativi',
Â  Â  Â  Â  Â  'no': 'Non implementata'
Â  Â  Â  Â  },
Â  Â  Â  Â  'wifi': {
Â  Â  Â  Â  Â  'yes-segmented': 'Reti separate',
Â  Â  Â  Â  Â  'yes-single': 'Rete singola',
Â  Â  Â  Â  Â  'yes-wpa3': 'Con WPA3',
Â  Â  Â  Â  Â  'no': 'No Wi-Fi'
Â  Â  Â  Â  },
Â  Â  Â  Â  'wifi-auth': {
Â  Â  Â  Â  Â  'wpa3-enterprise': 'WPA3-Enterprise',
Â  Â  Â  Â  Â  'wpa2-enterprise': 'WPA2-Enterprise',
Â  Â  Â  Â  Â  'wpa2-psk': 'WPA2-PSK',
Â  Â  Â  Â  Â  'captive-portal': 'Captive Portal',
Â  Â  Â  Â  Â  'open': 'Aperta'
Â  Â  Â  Â  },
Â  Â  Â  Â  'siem': {
Â  Â  Â  Â  Â  'yes-dedicated': 'SIEM Dedicato',
Â  Â  Â  Â  Â  'yes-cloud': 'Cloud SIEM',
Â  Â  Â  Â  Â  'basic-logging': 'Logging Base',
Â  Â  Â  Â  Â  'no': 'Nessun SIEM'
Â  Â  Â  Â  },
Â  Â  Â  Â  'monitoring': {
Â  Â  Â  Â  Â  'yes-24x7': '24x7 con SOC',
Â  Â  Â  Â  Â  'yes-automated': 'Automatizzato',
Â  Â  Â  Â  Â  'yes-business-hours': 'Orario lavorativo',
Â  Â  Â  Â  Â  'basic': 'Controlli periodici',
Â  Â  Â  Â  Â  'no': 'Nessuno'
Â  Â  Â  Â  },
Â  Â  Â  Â  'vuln-scan': {
Â  Â  Â  Â  Â  'continuous': 'Continuo',
Â  Â  Â  Â  Â  'monthly': 'Mensile',
Â  Â  Â  Â  Â  'quarterly': 'Trimestrale',
Â  Â  Â  Â  Â  'yearly': 'Annuale',
Â  Â  Â  Â  Â  'none': 'Mai eseguito'
Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  Â Â 
Â  Â  Â  return labels[fieldType]?.[value] || value || 'N/A';
Â  Â  }
Â  Â Â 
Â  Â  function saveNetworkConfig(event) {
Â  Â  Â  event.preventDefault
